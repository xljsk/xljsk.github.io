(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-77c2a1f0"],{"083a":function(t,e,i){"use strict";var a=i("0d51"),s=TypeError;t.exports=function(t,e){if(!delete t[e])throw s("Cannot delete property "+a(e)+" of "+a(t))}},2442:function(t,e,i){"use strict";i("abf7")},"352b":function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t._self._c;return e("main",{staticClass:"content"},[e("div",{staticClass:"content__body"},[e("div",{staticClass:"content__body__center"},[e("Quotation",{directives:[{name:"show",rawName:"v-show",value:t.isOpenQuotation,expression:"isOpenQuotation"}],ref:"quotation",staticClass:"quotation-wrap",attrs:{marketPairArr:t.quatationData,currentTradePair:`${t.tradeCoin}${t.priceCoin}`,exchangeName:t.exchangeName},on:{onChangeTradePair:t.onChangeTradePair}}),e("div",{staticClass:"chart-wrap",attrs:{id:"chartDom"}},[e("Detail",{attrs:{currentTradePair:`${t.tradeCoin}${t.priceCoin}`,detailData:t.detailData,symbolPrecision:t.symbolPrecision,marketPrice:t.marketPrice},on:{onChangeTheme:t.onChangeTheme,onChangePair:t.onChangePair}}),e("div",{staticClass:"empty"}),t.tradeCoin?e("Chart",{attrs:{socket:t.socket,currentTradePair:`${t.tradeCoin}-${t.priceCoin}`,theme:t.theme,klineData:t.klineData,updateDepthHightChartsTheme:t.updateDepthHightChartsTheme,symbolPrecision:t.symbolPrecision,exchangeName:t.exchangeName},on:{change:t.changeInterval}}):t._e()],1)],1),e("div",{staticClass:"content__body__right"},[e("div",{staticClass:"content-right-wrap"},[e("div",{staticClass:"right-tab-panel"},[e("input",{staticClass:"tab-panel-input",attrs:{id:"tabs-trades",name:"right-tab-radio",type:"radio",checked:""}}),e("label",{staticClass:"tab-panel-lable",attrs:{for:"tabs-trades"}},[t._v(" "+t._s(t.$t("exchange_order"))+" ")]),e("Handicap",{attrs:{handicapData:t.handicapData,currentTradePair:`${t.tradeCoin}${t.priceCoin}`,detailData:t.detailData,exchangeName:t.exchangeName,symbolPrecision:t.symbolPrecision}})],1),e("div",{staticClass:"right-tab-panel"},[e("input",{staticClass:"tab-panel-input",attrs:{id:"tabs-rell-time-deal",name:"right-tab-radio",type:"radio"}}),e("label",{staticClass:"tab-panel-lable",attrs:{for:"tabs-rell-time-deal"}},[t._v(" "+t._s(t.$t("exchange_trades"))+" ")]),e("Deal",{attrs:{dealData:t.dealData,currentTradePair:`${t.tradeCoin}${t.priceCoin}`,symbolPrecision:t.symbolPrecision}})],1)])])])])},s=[],n=(i("14d9"),i("3c65"),i("2f62")),r={name:"Exchange",components:{Chart:()=>i.e("chunk-5946d80a").then(i.bind(null,"c211")),Quotation:()=>i.e("chunk-43d54761").then(i.bind(null,"40c0")),Detail:()=>i.e("chunk-5ff07a15").then(i.bind(null,"0915")),Deal:()=>i.e("chunk-6836a1ce").then(i.bind(null,"f8cf")),Handicap:()=>i.e("chunk-3151b940").then(i.bind(null,"0798"))},props:{},data(){return{isShowDetail:!1,socket:null,currentTradePair:"",currentTradePairInfo:null,updateDepthHightChartsTheme:0,dialogVisibleIndex:!1,dialogVisible:!1,coinList:[],coinIsOpen:!0,futuresContractsList:[],currentpair:"",quatationData:[],detailData:{},dealData:[],marketPrice:{},handicapData:{},klineData:{},MAP_PERIOD:new Map([[0,"1m"],[1,"1m"],[2,"5m"],[3,"15m"],[4,"30m"],[5,"1h"],[6,"4h"],[7,"1d"],[8,"1w"],[9,"1M"]]),MAP_OKXPERIOD:new Map([[0,"1m"],[1,"1m"],[2,"5m"],[3,"15m"],[4,"30m"],[5,"1H"],[6,"4H"],[7,"1D"],[8,"1W"],[9,"1M"]]),interVal:3,isOpenQuotation:!1,exchangeName:"okx",timer:"",okxContractsList:[],tradeCoin:"",priceCoin:"",clickDetail:!1,theme:"dark"}},created(){this.$nextTick(()=>{this.initTheme()})},async mounted(){this.appStatus.tradeCoin&&this.appStatus.priceCoin?(this.tradeCoin=this.appStatus.tradeCoin,this.priceCoin=this.appStatus.priceCoin):(this.tradeCoin=this.$route.query.tradeCoin||"",this.priceCoin=this.$route.query.priceCoin||""),this.exchangeName=this.$route.query.exchange,window.addEventListener("click",this.clickArea,{passive:!0}),await this.getCoinList();let t=this.quatationData.findIndex(t=>t.tradeCoin==this.tradeCoin);-1==t&&(this.tradeCoin=this.quatationData[0].tradeCoin),this.currentpair=`${this.tradeCoin}${this.priceCoin}`.toLowerCase(),"okx"==this.exchangeName?(this.getOkxTrades(),this.handleInitOkxSocket()):(await this.getHistoryData(),this.handleInitSocket())},beforeDestroy(){"binance"==this.exchangeName?this.socket&&(this.socket.send(JSON.stringify({method:"UNSUBSCRIBE",params:[...this.futuresContractsList,this.currentpair+"@markPrice@1s",this.currentpair+"@depth20@500ms",this.currentpair+"@aggTrade",`${this.currentpair}_perpetual@continuousKline_${this.MAP_PERIOD.get(this.interVal)}`],id:2})),this.socket.close(),this.socket=null):(this.socket.send(JSON.stringify({op:"unsubscribe",args:[...this.okxContractsList,{channel:"mark-price",instId:`${this.tradeCoin}-${this.priceCoin}-SWAP`},{channel:"books",instId:`${this.tradeCoin}-${this.priceCoin}-SWAP`},{channel:"trades",instId:`${this.tradeCoin}-${this.priceCoin}-SWAP`},{channel:"candle"+this.MAP_OKXPERIOD.get(this.interVal),instId:`${this.tradeCoin}-${this.priceCoin}-SWAP`}]})),this.socket.close(),this.socket=null,clearInterval(this.timer)),this.$store.commit("UPDATE_APP_STATUS",{appStatus:{tradeCoin:"",priceCoin:""}})},computed:{...Object(n["d"])({token:"token",userInfo:"userInfo",appStatus:"appStatus",exchangeIsOpen:t=>t.appSessionStatus.siteConfig.exchange_is_open,bn_precise:t=>t.market.bn_precise,okx_precise:t=>t.market.okx_precise}),symbolPrecision(){let t=0;return t="okx"==this.exchangeName?this.okx_precise[`${this.tradeCoin}-${this.priceCoin}`.toUpperCase()]:this.bn_precise[`${this.tradeCoin}${this.priceCoin}`.toUpperCase()],t}},methods:{clickArea(t){if(t.target.closest(".quotation-wrap"));else{if(setTimeout(()=>{this.clickDetail=!1},1e3),this.clickDetail)return;this.isOpenQuotation=!1}},changeInterval(t){"okx"==this.exchangeName?(this.socket.send(JSON.stringify({op:"unsubscribe",args:[{channel:"candle"+this.MAP_OKXPERIOD.get(this.interVal),instId:`${this.tradeCoin}-${this.priceCoin}-SWAP`}]})),this.socket.send(JSON.stringify({op:"subscribe",args:[{channel:"candle"+this.MAP_OKXPERIOD.get(t),instId:`${this.tradeCoin}-${this.priceCoin}-SWAP`}]}))):(this.socket.send(JSON.stringify({method:"UNSUBSCRIBE",params:[`${this.currentpair}_perpetual@continuousKline_${this.MAP_PERIOD.get(this.interVal)}`],id:2})),this.socket.send(JSON.stringify({method:"SUBSCRIBE",params:[`${this.currentpair}_perpetual@continuousKline_${this.MAP_PERIOD.get(t)}`],id:2}))),this.interVal=t},async getCoinList(){try{const t=await this.$api.market.futuresContractsConfigList({status:1,exchange:this.exchangeName});if(t.success){for(let e of t.obj)this.futuresContractsList.push(`${e.tradeCoin.toLowerCase()}${e.priceCoin.toLowerCase()}@ticker`),this.okxContractsList.push({channel:"tickers",instId:`${e.tradeCoin}-${e.priceCoin}-SWAP`}),this.currentpair.toUpperCase()==e.symbolPair.toUpperCase()&&(this.tradeCoin=e.tradeCoin,this.priceCoin=e.priceCoin);this.quatationData=t.obj,this.currentpair||(this.currentpair=t.obj[0].symbolPair.toLowerCase())}}catch(t){this.$handleError.handleApiRequestException(t)}},async getHistoryData(){const t=await this.$api.exchange.aggTrades({limit:41,symbol:`${this.tradeCoin}${this.priceCoin}`});t&&(this.dealData=t)},async getOkxTrades(){const t=await this.$api.exchange.okxTrades({limit:41,instId:`${this.tradeCoin}-${this.priceCoin}-SWAP`});if(t.data&&t.data.length>0){const e=t.data.map(t=>{let e={};return e.T=t.ts,e.m="sell"==t.side,e.p=t.px,e.q=t.sz,e});this.dealData=e}},socketPing(){clearInterval(this.timer),this.timer=setInterval(()=>{this.socket.send("ping")},2e4)},handleInitOkxSocket(){this.socket=new WebSocket(this.$getEnv("VUE_APP_OKX_SOCKET_URL")),this.socket.onopen=()=>{this.socket.send(JSON.stringify({op:"subscribe",args:[...this.okxContractsList,{channel:"mark-price",instId:`${this.tradeCoin}-${this.priceCoin}-SWAP`},{channel:"books",instId:`${this.tradeCoin}-${this.priceCoin}-SWAP`},{channel:"trades",instId:`${this.tradeCoin}-${this.priceCoin}-SWAP`},{channel:"candle"+this.MAP_OKXPERIOD.get(this.interVal),instId:`${this.tradeCoin}-${this.priceCoin}-SWAP`}]}))},this.socket.onmessage=t=>{const e=JSON.parse(t.data);if(Array.isArray(e.data)){if("tickers"==e.arg.channel){const t=JSON.parse(JSON.stringify(this.quatationData));for(const i of t)if(`${i.tradeCoin}-${i.priceCoin}-SWAP`==e.data[0].instId){let t=(Number(e.data[0].last)-Number(e.data[0].open24h))/Number(e.data[0].open24h);i.P=(100*t).toFix(2),i.c=e.data[0].last,i.h=e.data[0].high24h,i.l=e.data[0].low24h,i.v=e.data[0].vol24h}this.quatationData=t;for(const e of t)e.tradeCoin==this.tradeCoin&&(this.detailData=e)}else if("mark-price"==e.arg.channel)this.marketPrice.p=e.data[0].markPx;else if("books"==e.arg.channel){const t={action:e.action,a:e.data[0].asks,b:e.data[0].bids};this.handicapData=t}else if("trades"==e.arg.channel){const t={T:Number(e.data[0].ts),m:"sell"==e.data[0].side,p:Number(e.data[0].px).toFix(1),q:e.data[0].sz/100};this.dealData.unshift(t),this.dealData=this.dealData.slice(0,41)}else if(e.arg.channel=="candle"+this.MAP_OKXPERIOD.get(this.interVal)){const t={t:e.data[0][0],o:e.data[0][1],h:e.data[0][2],l:e.data[0][3],c:e.data[0][4],v:e.data[0][6]};this.klineData=t}this.socketPing(e.arg.channel)}}},handleInitSocket(){this.socket=new WebSocket(this.$getEnv("VUE_APP_PUSHER_SOCKET_URL")),this.socket.onopen=()=>{this.socket.send(JSON.stringify({method:"SUBSCRIBE",params:[...this.futuresContractsList,this.currentpair+"@markPrice@1s",this.currentpair+"@depth20@500ms",this.currentpair+"@aggTrade",`${this.currentpair}_perpetual@continuousKline_${this.MAP_PERIOD.get(this.interVal)}`],id:2}))},this.socket.onmessage=t=>{const e=JSON.parse(t.data);if("24hrTicker"==e.e){const t=JSON.parse(JSON.stringify(this.quatationData));for(const i of t)`${i.tradeCoin}${i.priceCoin}`==e.s&&(i.P=e.P,i.c=e.c);this.quatationData=t,e.s==this.currentpair.toUpperCase()&&(this.detailData=e)}else"aggTrade"==e.e?(this.dealData.unshift(e),this.dealData=this.dealData.slice(0,41)):"markPriceUpdate"==e.e?this.marketPrice=e:"depthUpdate"==e.e?this.handicapData=e:"continuous_kline"==e.e&&(this.klineData=e.k)}},initTheme(){this.theme=this.$storage.getStorageSync("EXCHANGE_EXCHANGE_THEME",!0)||"dark",this.theme?document.getElementById("app").setAttribute("data-theme",this.theme):document.getElementById("app").setAttribute("data-theme","dark")},onChangeTradePair(t){this.isOpenQuotation=!1,"okx"==this.exchangeName?(this.socket.send(JSON.stringify({op:"unsubscribe",args:[{channel:"mark-price",instId:`${this.tradeCoin}-${this.priceCoin}-SWAP`},{channel:"books",instId:`${this.tradeCoin}-${this.priceCoin}-SWAP`},{channel:"trades",instId:`${this.tradeCoin}-${this.priceCoin}-SWAP`},{channel:"candle"+this.MAP_OKXPERIOD.get(this.interVal),instId:`${this.tradeCoin}-${this.priceCoin}-SWAP`}]})),this.priceCoin=t.priceCoin,this.tradeCoin=t.tradeCoin,this.getOkxTrades(),this.socket.send(JSON.stringify({op:"subscribe",args:[{channel:"mark-price",instId:`${t.tradeCoin}-${t.priceCoin}-SWAP`},{channel:"books",instId:`${t.tradeCoin}-${t.priceCoin}-SWAP`},{channel:"trades",instId:`${t.tradeCoin}-${t.priceCoin}-SWAP`},{channel:"candle"+this.MAP_OKXPERIOD.get(this.interVal),instId:`${t.tradeCoin}-${t.priceCoin}-SWAP`}]}))):(this.socket.send(JSON.stringify({method:"UNSUBSCRIBE",params:[this.currentpair+"@markPrice@1s",this.currentpair+"@depth20@500ms",this.currentpair+"@aggTrade",`${this.currentpair}_perpetual@continuousKline_${this.MAP_PERIOD.get(this.interVal)}`],id:2})),this.priceCoin=t.priceCoin,this.tradeCoin=t.tradeCoin,this.currentpair=`${t.tradeCoin}${t.priceCoin}`.toLowerCase(),this.getHistoryData(),this.socket.send(JSON.stringify({method:"SUBSCRIBE",params:[this.currentpair+"@markPrice@1s",this.currentpair+"@depth20@500ms",this.currentpair+"@aggTrade",`${this.currentpair}_perpetual@continuousKline_${this.MAP_PERIOD.get(this.interVal)}`],id:2}))),this.$store.commit("UPDATE_APP_STATUS",{appStatus:{tradeCoin:t.tradeCoin,priceCoin:t.priceCoin}})},onChangeTheme(){"dark"===document.getElementById("app").getAttribute("data-theme")?(this.theme="light",document.getElementById("app").setAttribute("data-theme","light"),this.$storage.setStorageSync("EXCHANGE_EXCHANGE_THEME","light",!0)):(this.theme="dark",document.getElementById("app").setAttribute("data-theme","dark"),this.$storage.setStorageSync("EXCHANGE_EXCHANGE_THEME","dark",!0)),this.updateDepthHightChartsTheme++},_getPageScrollY(t){return t||0==Number(t)?(self.pageYOffset&&(self.pageYOffset=Number(t)),document.documentElement&&document.documentElement.scrollTop&&(document.documentElement.scrollTop=Number(t)),document.body&&(document.body.scrollTop=Number(t)),!0):(self.pageYOffset?e=self.pageYOffset:document.documentElement&&document.documentElement.scrollTop?e=document.documentElement.scrollTop:document.body&&(e=document.body.scrollTop),e);var e},getSonFun(t){this.dialogVisibleIndex=t},onChangePair(){this.clickDetail=!0,this.isOpenQuotation=!this.isOpenQuotation}}},o=r,c=(i("2442"),i("2877")),h=Object(c["a"])(o,a,s,!1,null,"c6c70b3e",null);e["default"]=h.exports},"3c65":function(t,e,i){"use strict";var a=i("23e7"),s=i("7b0b"),n=i("07fa"),r=i("3a34"),o=i("083a"),c=i("3511"),h=1!==[].unshift(0),d=function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(t){return t instanceof TypeError}},l=h||!d();a({target:"Array",proto:!0,arity:1,forced:l},{unshift:function(t){var e=s(this),i=n(e),a=arguments.length;if(a){c(i+a);var h=i;while(h--){var d=h+a;h in e?e[d]=e[h]:o(e,d)}for(var l=0;l<a;l++)e[l]=arguments[l]}return r(e,i+a)}})},abf7:function(t,e,i){}}]);