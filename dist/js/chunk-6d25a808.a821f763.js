(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6d25a808"],{"0757":function(t,e,s){},"139f":function(t,e,s){},"16ae":function(t,e,s){"use strict";var i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"personal"},[e("div",{staticClass:"personal-left"},[e("Avatar",{attrs:{avatarSize:60,userId:t.userInfo.customerId,isShowNickname:!0,nicknameBoxStyle:{marginLeft:"20px",fontSize:"18px",fontWeight:500,color:"#3D3D3D",cursor:"pointer"}}})],1)])},o=[],n=s("2f62"),a=s("df3a"),c={name:"WorkspaceJsonPersonalInformation",components:{Avatar:a["a"]},data(){return{prefixUrl:"https://bandex-dev.oss-cn-shenzhen.aliyuncs.com",infoData:{}}},mounted(){},computed:{...Object(n["d"])(["userInfo"])},methods:{}},r=c,h=(s("60df"),s("2877")),m=Object(h["a"])(r,i,o,!1,null,"317850e0",null);e["a"]=m.exports},"1ca4":function(t,e,s){"use strict";s("0757")},"276f":function(t,e,s){},"28f4":function(t,e,s){},"3f76":function(t,e,s){"use strict";s("139f")},"591a":function(t,e,s){"use strict";s("276f")},"60df":function(t,e,s){"use strict";s("28f4")},"7b5ac":function(t,e,s){"use strict";s.r(e);var i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"content-wrap"},[e("div",{staticClass:"content-wrap-left"},[t.token?e("PersonalInformation",{staticClass:"information"}):t._e(),e("PostList")],1),e("div",{staticClass:"content-wrap-right"},[e("div",{class:{"right-position":t.isFixed,"right-hotposition":t.isHotFixed},attrs:{id:"right"}},[e("SearchHot"),e("HotPost")],1)])])},o=[],n=s("2f62"),a=s("16ae"),c=function(){var t=this,e=t._self._c;return e("div",[t._l(t.showList,(function(s,i){return e("div",{key:s.id,staticClass:"list",on:{click:function(e){return t.postDetailPush(s)}}},[e("Post",{attrs:{item:s,index:i},on:{handle:t.handle}})],1)})),0==t.showList.length?e("el-empty",{attrs:{image:s("e335"),"image-size":133,description:t.$t("notice_no_data")}}):e("div",{staticClass:"load-more"},[t._v(t._s(t.totalRows===t.showList.length?t.$t("notice_copy_over"):t.$t("notice_copy_load_more"))+" ")])],2)},r=[],h=(s("14d9"),s("bd46")),m=function(){var t=this,e=t._self._c;return e("div",{staticClass:"wrap"},[e("div",{staticClass:"comment",on:{click:function(e){return e.stopPropagation(),t.commentDetailPush(t.item)}}},[e("div",{staticClass:"comment-hd"},[e("div",{staticClass:"comment-hd-left"},[t.item.commentAuthor?e("Avatar",{attrs:{avatarSize:30,userId:t.item.commentAuthor,isShowNickname:!0,nicknameBoxStyle:{marginLeft:"10px"}}}):t._e()],1),e("div",{staticClass:"comment-right",on:{click:function(e){return e.stopPropagation(),t.postCommentLikeOrDislike(t.item)}}},[e("svg-icon",{class:{select:t.item.isLikeComment},attrs:{data_iconName:"awesome",className:"comment-icon",size:16}}),e("div",{staticClass:"comment-up"},[t._v(t._s(t.item.commentUp))])],1)]),e("div",{staticClass:"comment-content"},[t._v(t._s(t.item.comment))])])])},l=[],d=s("df3a"),u={name:"WorkspaceJsonComment",components:{Avatar:d["a"]},props:{item:Object},data(){return{flag:!1}},mounted(){},computed:{...Object(n["d"])(["token"])},methods:{commentDetailPush(t){if(3===t.commentStatus)return this.$notify({type:"warning",message:this.$t("community_comment_deleted")});this.$router.push(`/community/community-post/${t.trendsId}/${t.author}`)},postCommentLikeOrDislike(t){this.token?(t.isLikeComment?this.cancelLike(t):this.handleLike(t),this.flag=!0):this.$router.push("/login")},async cancelLike(t){try{if(this.flag)return;const e=await this.$api.community.cancelLike({trendsId:t.trendsId,commentId:t.commentId,likeType:1,likeObj:2});e.success&&(this.flag=!1,this.$notify({message:this.$t("community_cancel_success"),type:"success"}),this.$emit("handle",5,t.commentId))}catch(e){this.flag=!1,this.$handleError.handleApiRequestException(e)}},async handleLike(t){try{if(this.flag)return;const e=await this.$api.community.communityLike({trendsId:t.trendsId,commentId:t.commentId,likeType:1,likeObj:2});e.success&&(this.flag=!1,this.$notify({message:this.$t("community_liked_successfully"),type:"success"}),this.$emit("handle",4,t.commentId))}catch(e){this.flag=!1,this.$handleError.handleApiRequestException(e)}}}},f=u,p=(s("591a"),s("2877")),g=Object(p["a"])(f,m,l,!1,null,"3989669e",null),y=g.exports,w={name:"WorkspaceJsonPostList",components:{Post:h["a"],Comment:y},data(){return{prefixUrl:"https://bandex-dev.oss-cn-shenzhen.aliyuncs.com",page:1,size:10,totalRows:0,showList:[],isLoadingNextPage:!1,hasMore:!1,change:0}},computed:{...Object(n["d"])(["token","userInfo","community"])},watch:{community(t){this.hasMore=!1,5===t?this.getMyDynamic(!0,2):6===t&&this.getMyDynamic(!0,1),window.scrollTo(0,0)}},mounted(){5===this.community?this.getMyDynamic(!0,2):6===this.community&&this.getMyDynamic(!0,1),window.addEventListener("scroll",this.scrollBottom)},destroyed(){window.removeEventListener("scroll",this.scrollBottom)},methods:{postDetailPush(t){if(3===t.trendsStatus)return this.$notify({type:"warning",message:this.$t("community_post_deleted")});this.$router.push(`/community/community-post/${t.trendsId}/${t.author}`)},scrollBottom(){let t=document.documentElement.scrollTop||document.body.scrollTop,e=document.documentElement.scrollHeight||document.body.scrollHeight;e-t<=2700&&this.isLoadingNextPage&&(5===this.community?this.getMyDynamic(!1,2):6===this.community&&this.getMyDynamic(!1,1),this.isLoadingNextPage=!1)},handle(t,e){if(0===t)for(let s of this.showList)s.trendsId==e&&(s.isLike=!1,s.up=s.up-1);if(1===t)for(let s of this.showList)s.trendsId==e&&(s.isLike=!0,s.up=s.up+1);if(2===t)for(let s of this.showList)s.author==e&&(s.isFollow=!0);if(3===t)for(let s of this.showList)s.author==e&&(s.isFollow=!1);if(4===t)for(let s of this.showList)s.commentId==e&&(s.isLikeComment=!0,s.commentUp=s.commentUp+1);if(5===t)for(let s of this.showList)s.commentId==e&&(s.isLikeComment=!1,s.commentUp=s.commentUp-1)},async getMyDynamic(t,e){if(t&&(this.page=1),!this.hasMore)try{const s=await this.$api.community.getMyDynamic({page:this.page,size:this.size,type:e});if(s.success&&s.obj.data){let e=s.obj.data;if(this.totalRows=s.obj.totalRows,1===this.page&&0===e.length)return this.showList=e;e.length>0&&this.handleData(e,t),this.page*this.size<=this.totalRows&&(this.page=this.page+1),e.length<this.size&&(this.hasMore=!0)}}catch(s){this.$handleError.handleApiRequestException(s)}},async handleData(t,e){if(t.forEach(t=>{if(t.attachContent){let e=JSON.parse(t.attachContent),s=[];e&&(e.map(e=>{1===e.type&&(t.href=this.$utils.decodeURIComponentSafely(e.url)),2===e.type&&s.push(this.prefixUrl+e.url),3===e.type&&(t.videoUrl=e.url)}),s.length&&(t.urls=s))}t.author=t.trendsAuthor,t.up=t.trendsUp,t.comments=t.trendsComments,t.postLikesType=1}),t.length>0){const s=await this.checkIsLikeTrends(t);for(let e of t)for(let t in s)e.trendsId==t&&(e.isLike=s[t]);const i=await this.checkIsFollow(t);for(let e of t)for(let t in i)e.author==t&&(e.isFollow=i[t]);const o=await this.checkIsLikeComment(t);for(let e of t)for(let t in o)e.commentId==t&&(e.isLikeComment=o[t]);this.showList=e?t:this.showList.concat(t),this.isLoadingNextPage=!0}},async checkIsLikeTrends(t){try{if(!this.token)return;const e=[];if(t&&t.length>0)for(let i of t)e.push(i.trendsId);const s=await this.$api.community.checkIsLikeTrends({trendsIds:String(e)});return s.obj}catch(e){this.$handleError.handleApiRequestException(e)}},async checkIsFollow(t){try{if(!this.token)return;const e=[];if(t&&t.length>0)for(let i of t)e.push(i.trendsAuthor);const s=await this.$api.community.checkIsFollow({userIds:String(e)});return s.obj}catch(e){this.$handleError.handleApiRequestException(e)}},async checkIsLikeComment(t){try{if(!this.token)return;const e=[];if(t&&t.length>0)for(let i of t)i.commentId&&e.push(i.commentId);if(e.length<=0)return;const s=await this.$api.community.checkIsLikeComment({commentIds:String(e)});return s.obj}catch(e){this.$handleError.handleApiRequestException(e)}}}},k=w,L=(s("1ca4"),Object(p["a"])(k,c,r,!1,null,"918f5f04",null)),I=L.exports,v=s("1943"),$=s("e671"),_={name:"WorkspaceJsonIndex",components:{PersonalInformation:a["a"],PostList:I,SearchHot:v["a"],HotPost:$["a"]},data(){return{screenHeight:"",isFixed:!1,isHotFixed:!1,offsetTop:20,rightHeight:0}},computed:{...Object(n["d"])(["token","userInfo"])},mounted(){window.addEventListener("scroll",this.initHeight),this.screenHeight=document.body.clientHeight,window.onresize=()=>(()=>{this.screenHeight=document.body.clientHeight})();var t=document.getElementById("right");this.rightHeight=t.offsetHeight},methods:{initHeight(){var t=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop;this.isHotFixed=t>20}},destroyed(){window.removeEventListener("scroll",this.initHeight)}},x=_,C=(s("3f76"),Object(p["a"])(x,i,o,!1,null,"143d0b04",null));e["default"]=C.exports}}]);