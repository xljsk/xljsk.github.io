(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5f99b198"],{1983:function(t,e,i){"use strict";i("ccb0")},"7b0be":function(t,e,i){"use strict";i.r(e);i("14d9");var s=function(){var t=this,e=t._self._c;return e("div",{staticClass:"face"},[e("div",{staticClass:"title"},[e("div",[t._v(t._s(t.$t("account_center_post_ticket")))]),e("div",{staticClass:"title-right",on:{click:function(e){return t.$router.push("/mine/ticket/my-ticket")}}},[t._v(t._s(t.$t("account_center_order")))])]),e("div",{staticClass:"content-box"},[e("div",{staticClass:"content-title"},[t._v(t._s(t.$t("account_center_question_type")))]),e("div",{staticClass:"content-system"},t._l(t.categoryList,(function(i,s){return e("div",{key:s,staticClass:"content-list",class:{"content-select":t.categoryId===i.id},on:{click:function(e){return t.typeNameModus(i)}}},[t._v(t._s(i.typeName))])})),0),e("div",{staticClass:"content-feedback"},[e("span",[t._v(t._s(t.$t("account_center_feedback")))]),e("span",{staticClass:"content-feedback-right"},[t._v(t._s(t.$t("account_center_screenshots")))])]),e("div",{staticClass:"content-input"},[e("el-input",{attrs:{type:"textarea",placeholder:t.$t("account_center_enter_content"),maxlength:"200",rows:3,resize:"none"},model:{value:t.workContent,callback:function(e){t.workContent=e},expression:"workContent"}})],1),e("div",{staticClass:"content-feedback"},[e("span",[t._v(t._s(t.$t("account_center_upload_image")))]),e("span",{staticClass:"content-feedback-right"},[t._v(t._s(t.$t("account_center_relevant_picture")))])]),e("div",[e("div",{staticClass:"upload-pictures"},[e("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{action:"","list-type":"picture-card","auto-upload":!1,"on-exceed":t.handleExceed,"on-preview":t.handlePictureCardPreview,"on-remove":t.handleRemove,"on-change":t.handleChange,limit:6}},[e("i",{staticClass:"el-icon-plus"})]),e("el-dialog",{attrs:{visible:t.dialogVisible},on:{"update:visible":function(e){t.dialogVisible=e}}},[e("img",{attrs:{width:"100%",src:t.dialogImageUrl,alt:""}})])],1)]),e("el-button",{staticClass:"content-submit",attrs:{disabled:t.flag},on:{click:t.addOrder}},[t._v(" "+t._s(t.flag?t.$t("account_center_submitting"):t.$t("account_center_submit_now"))+" ")])],1)])},n=[],a=i("6ca8"),c=i.n(a),o={name:"WorkspaceJsonAddTicket",data(){return{workContent:"",categoryList:[],categoryId:"",dialogImageUrl:"",dialogVisible:!1,disabled:!1,fileList:[],flag:!1,imgcount:0,titleImageArr:[],pictureUrl:""}},mounted(){this.findWorkOrderCategoryList()},watch:{async imgcount(t){t==this.fileList.length&&(this.imgcount=0,await this.addpicture(this.titleImageArr),await this.addAppeal())}},methods:{async findWorkOrderCategoryList(){const t=await this.$api.mine.findWorkOrderCategoryList();t.success&&(this.categoryList=t.obj,this.categoryId=t.obj[0].id)},typeNameModus(t){this.categoryId=t.id},uploadImage(){document.getElementsByClassName("el-upload__input").file.click()},handleExceed(){this.$notify({type:"warning",message:this.$t("account_center_upload_limit",[6])})},handlePictureCardPreview(t){this.dialogImageUrl=t.url,this.dialogVisible=!0},handleRemove(t,e){console.log("handleRemove===>",t,e),this.fileList=e,this.fileList.length<6&&setTimeout(()=>{document.getElementsByClassName("el-upload--picture-card")[0].style.display=""},1e3)},handleChange(t,e){console.log("handleChange==>",t,e);const i=t.size/1024/1024<4;if(!i)return this.$refs.upload.handleRemove(t,e),void this.$notify({type:"warning",message:this.$t("account_center_exceed")});let s=t.name.split(".")[t.name.split(".").length-1];if("jpg"!==s&&"png"!==s&&"jpeg"!==s&&"bmp"!=s)return this.$refs.upload.handleRemove(t,e),void this.$notify({type:"warning",message:this.$t("account_center_format")});this.fileList=e,console.log("fileList",this.fileList),this.fileList.length>=6&&(document.getElementsByClassName("el-upload--picture-card")[0].style.display="none")},async addOrder(){if(""!=this.workContent)if(this.workContent.length<10||this.workContent.length>200)this.$notify({type:"warning",message:this.$t("account_center_feedback_content")});else if(this.flag=!0,0!=this.fileList.length)for(let t of this.fileList)c()(t.raw,{quality:.2}).then(t=>{let e=t.origin.name,i=t.origin.type,s=new File([t.file],e,{type:i});this.titleImageArr.push({file:s}),console.log("bbb",this.titleImageArr),this.imgcount++}).catch(t=>{this.$handleError.handleApiRequestException(t)});else this.addAppeal();else this.$notify({type:"warning",message:this.$t("account_center_fill_feedback")})},async addpicture(t){let e=new FormData;for(let s of t)e.append("file",s.file);console.log("555==>",e);const i=await this.$api.mine.uploadApi(e);i.success&&(this.pictureUrl=i.obj.toString())},async addAppeal(){const t=await this.$api.mine.addWorkOrder({categoryId:this.categoryId,workContent:this.workContent,imgUrl:this.pictureUrl});t.success?(this.content="",this.pictureUrl="",this.$notify({type:"success",message:this.$t(t.code)}),this.$router.push("/mine/ticket/my-ticket"),this.flag=!1):this.flag=!1}}},l=o,r=(i("1983"),i("2877")),d=Object(r["a"])(l,s,n,!1,null,"7f352e74",null);e["default"]=d.exports},ccb0:function(t,e,i){}}]);