(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7cb454e0"],{"104e":function(t,e,i){},"1d55":function(t,e,i){},"375ab":function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t._self._c;return e("div",{staticClass:"container"},[e("formVue",{attrs:{exchangeName:t.exchangeName,currentTradePair:""+t.tradeCoin,symbolPrecision:t.symbolPrecision,spotPrice:t.spotPrice,futurePrice:t.futurePrice},on:{toggleExchange:t.toggleExchange,toggleSymbol:t.toggleSymbol,orderSuccess:t.orderSuccess}}),e("handicap",{attrs:{spotHandicapData:t.spotHandicapData,futureHandicapData:t.futureHandicapData,currentTradePair:`${t.tradeCoin}${t.priceCoin}`,exchangeName:t.exchangeName,symbolPrecision:t.symbolPrecision,spotPrice:t.spotPrice,futurePrice:t.futurePrice}}),t.tradeCoin?e("chart",{attrs:{socket:t.socket,currentTradePair:`${t.tradeCoin}-${t.priceCoin}${1==this.chartId?"":"-SWAP"}`,theme:t.theme,klineData:t.klineData,updateDepthHightChartsTheme:t.updateDepthHightChartsTheme,chartId:t.chartId,symbolPrecision:t.symbolPrecision,exchangeName:t.exchangeName},on:{change:t.changeInterval,toggleChart:t.toggleChart}}):t._e(),e("entrust",{ref:"entrust"})],1)},a=[],n=function(){var t=this,e=t._self._c;return e("div",{staticClass:"main",attrs:{id:"chartDom"}},[e("div",{staticClass:"chart-top"},[e("div",{staticClass:"tabs-box"},[e("div",{staticClass:"tabs-item",class:1==t.chartId?"active":"",on:{click:function(e){return t.toggleChart(1)}}},[t._v(t._s(t.$t("arbitrage_left_leg")))]),e("div",{staticClass:"tabs-item",class:2==t.chartId?"active":"",on:{click:function(e){return t.toggleChart(2)}}},[t._v(t._s(t.$t("arbitrage_right_leg")))])])]),e("div",{staticClass:"chart-body-wrap"},[e("div",{staticClass:"chart-action-header"},["Kline"===t.pageState.chartsShow?e("div",{staticClass:"chart-action"},[e("div",{staticClass:"max-screen"},t._l(t.klineConfig.supportedResolutions,(function(i){return e("div",{key:i.id,staticClass:"chart-action-item",class:t.klineConfig.interval===i.id?"cur":"",on:{click:function(e){return t.toggleInterval(i.id)}}},[t._v(" "+t._s(i.name)+" ")])})),0),e("div",{staticClass:"min-screen"},[e("div",{staticClass:"chart-action-item",class:0===t.klineConfig.interval?"cur":"",on:{click:function(e){return t.toggleInterval(0)}}},[t._v(" "+t._s(t.$t("exchange_time"))+" ")]),e("div",{staticClass:"chart-action-item m-width",class:[1,2,3,4].includes(t.klineConfig.interval)?"cur":""},[e("div",{staticClass:"action-item-btn"},[t._v(" "+t._s([1,2,3,4].includes(t.klineConfig.interval)?t.Resolutions[t.klineConfig.interval]:"m")+" ")]),e("div",{staticClass:"select"},[e("div",{on:{click:function(e){return t.toggleInterval(1)}}},[t._v(t._s(this.$t("exchange_m",[1])))]),e("div",{on:{click:function(e){return t.toggleInterval(2)}}},[t._v(t._s(this.$t("exchange_m",[5])))]),e("div",{on:{click:function(e){return t.toggleInterval(3)}}},[t._v(t._s(this.$t("exchange_m",[15])))]),e("div",{on:{click:function(e){return t.toggleInterval(4)}}},[t._v(t._s(this.$t("exchange_m",[30])))])])]),e("div",{staticClass:"chart-action-item m-width",class:[5,6].includes(t.klineConfig.interval)?"cur":""},[e("div",{staticClass:"action-item-btn"},[t._v(" "+t._s([5,6].includes(t.klineConfig.interval)?t.Resolutions[t.klineConfig.interval]:"h")+" ")]),e("div",{staticClass:"select"},[e("div",{on:{click:function(e){return t.toggleInterval(5)}}},[t._v(t._s(t.$t("exchange_h",[1])))]),e("div",{on:{click:function(e){return t.toggleInterval(6)}}},[t._v(t._s(t.$t("exchange_h",[4])))])])]),e("div",{staticClass:"chart-action-item",class:7===t.klineConfig.interval?"cur":"",on:{click:function(e){return t.toggleInterval(7)}}},[t._v(" "+t._s(t.$t("exchange_d",[1]))+" ")]),e("div",{staticClass:"chart-action-item",class:8===t.klineConfig.interval?"cur":"",on:{click:function(e){return t.toggleInterval(8)}}},[t._v(" "+t._s(t.$t("exchange_w"))+" ")]),e("div",{staticClass:"chart-action-item",class:9===t.klineConfig.interval?"cur":"",on:{click:function(e){return t.toggleInterval(9)}}},[t._v(" "+t._s(t.$t("exchange_M"))+" ")])]),e("el-tooltip",{attrs:{effect:"dark",content:"全屏",placement:"top",transition:""}},[e("div",{staticStyle:{display:"flex","align-items":"center"},on:{click:t.handleChartsFullScreen}},[e("svg-icon",{staticClass:"svg-icon",attrs:{data_iconName:"fullScreen",size:"16"}})],1)])],1):t._e()]),e("div",{staticClass:"chart-body",class:{"chart-body-hidden":"Kline"!==t.pageState.chartsShow}},[e("Kline",{ref:"kline",attrs:{currentTradePair:t.currentTradePair,theme:t.theme,klineData:t.klineData,interval:t.klineConfig.interval,timezone:t.klineConfig.timezone,symbolPrecision:t.symbolPrecision,exchangeName:t.exchangeName,chartId:t.chartId}})],1)])])},r=[],o={name:"ChartWrap",components:{Kline:()=>i.e("chunk-2ab13250").then(i.bind(null,"397b"))},props:{klineData:{required:!0},currentTradePair:{required:!0},theme:{type:String,default:"dark"},updateDepthHightChartsTheme:{required:!0},symbolPrecision:{type:Number,default:0},exchangeName:{type:String},chartId:{type:Number,default:1}},data(){return{pageState:{chartsShow:"Kline",handicapShowType:"all",documentTitle:"",isBuyButtonLoading:!1,isSellButtonLoading:!1,isDeepthChartsLoading:!0,title:""},klineConfig:{args:null,interval:3,supportedResolutions:[{name:this.$t("exchange_time"),id:0},{name:this.$t("exchange_m",[1]),id:1},{name:this.$t("exchange_m",[5]),id:2},{name:this.$t("exchange_m",[15]),id:3},{name:this.$t("exchange_m",[30]),id:4},{name:this.$t("exchange_h",[1]),id:5},{name:this.$t("exchange_h",[4]),id:6},{name:this.$t("exchange_d",[1]),id:7},{name:this.$t("exchange_w"),id:8},{name:this.$t("exchange_M"),id:9}],timezone:"Asia/Shanghai"},Resolutions:{0:this.$t("exchange_time"),1:this.$t("exchange_m",[1]),2:this.$t("exchange_m",[5]),3:this.$t("exchange_m",[15]),4:this.$t("exchange_m",[30]),5:this.$t("exchange_h",[1]),6:this.$t("exchange_h",[4]),7:this.$t("exchange_d",[1]),8:this.$t("exchange_w"),9:this.$t("exchange_M")},isFullScreen:!1}},created(){window.onresize=()=>{this.checkFull()||(this.isFullScreen=!1)}},computed:{},methods:{checkFull(){let t=document.mozFullScreen||document.fullScreen||document.webkitIsFullScreen||document.webkitRequestFullScreen||document.mozRequestFullScreen||document.msFullscreenEnabled;return void 0===t&&(t=!1),t},toggleInterval(t){this.klineConfig.interval=t,this.$emit("change",t)},toggleChart(t){this.$emit("toggleChart",t)},handleChartsFullScreen(){if(document.fullscreenElement)document.exitFullscreen(),this.isFullScreen=!1;else{this.isFullScreen=!0;const t=document.getElementById("chartDom"),e=t.requestFullScreen||t.webkitRequestFullScreen||t.mozRequestFullScreen||t.msRequestFullScreen;if(e)e.call(t);else if("undefined"!==typeof window.ActiveXObject){const t=new window.ActiveXObject("WScript.Shell");null!==t&&t.SendKeys("{F11}")}}}}},c=o,l=(i("8b43"),i("2877")),h=Object(l["a"])(c,n,r,!1,null,"4fb15bd1",null),d=h.exports,u=function(){var t,e=this,i=e._self._c;return i("div",{staticClass:"main"},[i("div",{staticClass:"top-box"},[e._v(" "+e._s(e.$t("arbitrage_title"))+" ")]),i("div",{staticClass:"content"},[i("div",{staticClass:"btn-box"},[i("div",{staticClass:"btn",class:"okx"==e.exchange?"":"active",on:{click:function(t){return e.toggle("binance")}}},[e._v("Binance")]),i("div",{staticClass:"btn",class:"okx"==e.exchange?"active":"",on:{click:function(t){return e.toggle("okx")}}},[e._v("OKX")])]),i("div",{staticClass:"symbol-box"},[i("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:e.$t("arbitration_Please_select")},on:{change:e.selectChange},model:{value:e.symbolIndex,callback:function(t){e.symbolIndex=t},expression:"symbolIndex"}},e._l(e.symbolList,(function(t,e){return i("el-option",{key:e,attrs:{label:t.symbol,value:e}})})),1)],1),i("div",{staticClass:"middle-box"},[i("div",{staticClass:"box-item"},[i("div",{staticClass:"box-item-title"},[e._v(e._s(e.$t("arbitrage_arbitrage",[3])))]),i("div",{staticClass:"box-item-percent",class:e.APR3>=0?"green":"red"},[e._v(e._s(e.APR3.toFix(2))+"%")])]),i("div",{staticClass:"box-item"},[i("div",{staticClass:"box-item-title"},[e._v(e._s(e.$t("arbitrage_arbitrage",[7])))]),i("div",{staticClass:"box-item-percent",class:e.APR7>=0?"green":"red"},[e._v(e._s(e.APR7.toFix(2))+"%")])]),i("div",{staticClass:"box-item"},[i("div",{staticClass:"box-item-title"},[e._v(e._s(e.$t("arbitrage_arbitrage",[30])))]),i("div",{staticClass:"box-item-percent",class:e.APR30>=0?"green":"red"},[e._v(e._s(e.APR30.toFix(2))+"%")])])]),i("div",{staticClass:"input-class"},[i("el-input",{staticStyle:{color:"var(--color-text-two)"},attrs:{type:"number",placeholder:e.$t("arbitrage_amount")},on:{input:e.priceChange},model:{value:e.price,callback:function(t){e.price=t},expression:"price"}},[i("template",{slot:"append"},[e._v(" USDT ")])],2)],1),i("div",{staticClass:"asset-box"},[i("span",[e._v(e._s(e.$t("arbitrage_Available_Funds")))]),i("span",{staticStyle:{color:"var(--color-text-four)"}},[e._v("="+e._s(e.availableTotalMoney)+" USDT")])]),i("div",{staticClass:"asset-box"},[i("span",[e._v(e._s(e.$t("arbitration_funding_rate")))]),i("span",{staticStyle:{color:"var(--color-text-four)"}},[e._v(e._s((100*e.fundingRate).toFix(4))+"%/ "+e._s(e.nextFundingTime?e.$dayjs(Number(e.nextFundingTime)).format("HH:mm:ss"):e.nextFundingTimefn())+" ")])]),i("div",{staticClass:"slider"},[i("el-slider",{on:{change:e.sliderChange},model:{value:e.percent,callback:function(t){e.percent=t},expression:"percent"}}),e._m(0),i("div",{staticStyle:{"margin-top":"10px","font-size":"12px",color:"var(--color-text-four)"}},[e._v(e._s(e.$t("arbitrage_Total_stake",[null===(t=this.symbolList[this.symbolIndex])||void 0===t?void 0:t.minSize])))])],1),i("div",{staticClass:"lever-box"},[i("p",{staticClass:"title"},[e._v(e._s(e.$t("arbitrage_Leverage")))]),i("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:e.$t("arbitrage_Please_leverage")},model:{value:e.lever,callback:function(t){e.lever=t},expression:"lever"}},e._l(e.leverList,(function(t){return i("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1),i("div",{staticClass:"lever-box-bottom"},[i("div",[e._v(e._s(e.$t("arbitrage_Current_price")))]),i("div",{staticStyle:{color:"var(--color-text-four)"}},[e._v(e._s(e.priceSpreads))])])],1),i("div",{staticClass:"btn-bottom",on:{click:e.onOrder}},[e._v(e._s(e.token?e.$t("arbitrage_Order"):e.$t("arbitrage_login")))])])])},g=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"slider-num"},[e("div",{staticClass:"min"},[t._v("0")]),e("div",{staticClass:"max"},[t._v("100%")])])}],p=(i("14d9"),i("2f62")),m={props:{exchangeName:{type:String},currentTradePair:{required:!0},symbolPrecision:{type:Number,default:0},spotPrice:{required:!0},futurePrice:{required:!0}},data(){return{exchange:this.exchangeName,price:"",percent:0,lever:"2",leverList:[{label:"1X",value:"1"},{label:"2X",value:"2"},{label:"3X",value:"3"}],symbolList:[],symbolIndex:"",APR3:0,APR7:0,APR30:0,depositAccount:{},availableTotalMoney:0,fundingRate:0,nextFundingTime:0,priceSpread:0}},mounted(){console.log(this.futurePrice),this.$nextTick(async()=>{this.exchange=this.exchangeName,await this.getArbitrageList(),this.getDepositAccountBalance(),"binance"==this.exchangeName?(this.onGetBinanceRate(),this.getFundingRate()):(this.onGetOkxRate(),this.getFundingRateOkx())})},computed:{...Object(p["d"])(["token","userInfo"]),priceSpreads(){return this.futurePrice&&this.spotPrice?this.$NP.minus(this.futurePrice,this.spotPrice).toFix(this.symbolPrecision):0}},methods:{nextFundingTimefn(){return this.$dayjs().format("HH")<8?"08:00:00":this.$dayjs().format("HH")<16?"16:00:00":"00:00:00"},priceChange(t){this.price=String(t).replace(/^(.*\..{4}).*$/,"$1"),this.percent=Number((t/this.availableTotalMoney*100).toFix(4))},sliderChange(t){this.availableTotalMoney&&(this.price=Number((this.availableTotalMoney*t/100).toFix(4)))},toggle(t){this.exchange=t,this.symbolIndex="",this.$debounce(async()=>{this.exchangeName!=t&&(await this.getArbitrageList(),"binance"==t?(this.onGetBinanceRate(),this.getFundingRate()):(this.onGetOkxRate(),this.getFundingRateOkx()),this.$emit("toggleExchange",{name:t,symbol:this.symbolList[0].symbol}))})},selectChange(t){"binance"==this.exchangeName?(this.onGetBinanceRate(),this.getFundingRate()):(this.onGetOkxRate(),this.getFundingRateOkx()),this.$emit("toggleSymbol",this.symbolList[t].symbol)},async getFundingRate(){const t=await this.$api.arbitrage.getFundingRate({symbol:this.symbolList[this.symbolIndex].leftLegSymbol});this.fundingRate=t.lastFundingRate,this.nextFundingTime=t.nextFundingTime,this.priceSpread=t.indexPrice-t.markPrice},async getFundingRateOkx(){const t=await this.$api.arbitrage.getFundingRateOkx({instId:this.symbolList[this.symbolIndex].leftLegSymbol+"-SWAP"}),e=await this.$api.arbitrage.getMarkPriceOkx({instType:"SWAP",instId:this.symbolList[this.symbolIndex].leftLegSymbol+"-SWAP"}),i=await this.$api.arbitrage.getIndexTickersOkx({instId:""+this.symbolList[this.symbolIndex].leftLegSymbol});let s=0,a=0;if("0"===(null===i||void 0===i?void 0:i.code)){var n,r;const t=(null===i||void 0===i||null===(n=i.data)||void 0===n||null===(r=n[0])||void 0===r?void 0:r.idxPx)||0;s=t}if("0"===(null===e||void 0===e?void 0:e.code)){var o,c;const t=(null===e||void 0===e||null===(o=e.data)||void 0===o||null===(c=o[0])||void 0===c?void 0:c.markPx)||0;a=t}this.fundingRate=t.data[0].fundingRate,this.priceSpread=s-a},async onGetBinanceRate(){console.log(this.symbolIndex,"this.symbolIndex");const t=(new Date).getTime(),e=await this.$api.market.fundingRate({symbol:this.symbolList[this.symbolIndex].leftLegSymbol,startTime:t-6048e5,endTime:t,limit:1e3});let i=0;for(const o of e||[])i+=Number(null===o||void 0===o?void 0:o.fundingRate)||0;this.APR7=365*i/7;const s=await this.$api.market.fundingRate({symbol:this.symbolList[this.symbolIndex].leftLegSymbol,startTime:t-2592e6,endTime:t,limit:1e3});let a=0;for(const o of s||[])a+=Number(null===o||void 0===o?void 0:o.fundingRate)||0;this.APR30=365*a/30;const n=await this.$api.market.fundingRate({symbol:this.symbolList[this.symbolIndex].leftLegSymbol,startTime:t-2592e5,endTime:t,limit:1e3});let r=0;for(const o of n||[])r+=Number(null===o||void 0===o?void 0:o.fundingRate)||0;this.APR3=365*r/3},async onGetOkxRate(){const t=(new Date).getTime(),e=this.symbolList[this.symbolIndex].leftLegSymbol,i=await this.$api.arbitrage.onGetFundingRateHistory({instId:e+"-SWAP",before:t-2592e5,after:t,limit:100});console.log("onGetOkxRate",i);let s=0;for(const c of i.data||[])s+=Number(null===c||void 0===c?void 0:c.fundingRate)||0;this.APR3=365*s/3;const a=await this.$api.arbitrage.onGetFundingRateHistory({instId:e+"-SWAP",before:t-6048e5,after:t,limit:100});let n=0;for(const c of a.data||[])n+=Number(null===c||void 0===c?void 0:c.fundingRate)||0;this.APR7=365*n/7;const r=await this.$api.arbitrage.onGetFundingRateHistory({instId:e+"-SWAP",before:t-6048e5,after:t,limit:100});let o=0;for(const c of r.data||[])o+=Number(null===c||void 0===c?void 0:c.fundingRate)||0;this.APR30=365*o/30},async getDepositAccountBalance(){if(this.token){const t=await this.$api.assets.getDepositAccountBalance({issueState:1});if(console.log("getDepositAccountBalance",t),t.success){const e={totalMoney:t.obj.totalMoney,totalColdMoney:t.obj.totalColdMoney,totalHotMoney:t.obj.totalHotMoney};t.obj.productList.map(t=>{"USDT"===t.coinCode&&(console.log(this.$utils.P(t.hotMoney)),this.availableTotalMoney=this.$utils.P(t.hotMoney))}),this.depositAccount=e}else this.depositAccount={totalMoney:0,totalColdMoney:0,totalHotMoney:0},this.availableTotalMoney=0}else this.depositAccount={totalMoney:0,totalColdMoney:0,totalHotMoney:0},this.availableTotalMoney=0},async onOrder(){if(this.token){if(!this.price)return this.$message({type:"warning",message:this.$t("arbitrage_amount")});const t=await this.$api.arbitrage.onOrder({userId:this.userInfo.customerId,targetSize:this.price,arbitrageConfigId:this.symbolList[this.symbolIndex].id,leverage:this.lever,orderType:1,sizeType:1});t.success&&(this.getDepositAccountBalance(),this.price="",this.$message({type:"success",message:this.$t("arbitrage_successfully")}),this.$emit("orderSuccess"))}else this.$router.push("/login")},async getArbitrageList(){const t=await this.$api.market.getArbitrageList({exchange:this.exchange,pageSize:1e3});t.success&&(this.symbolList=t.obj.records,0!==t.obj.records.length&&(this.symbolIndex=0))}}},_=m,b=(i("68a8"),Object(l["a"])(_,u,g,!1,null,"07aaeed9",null)),v=b.exports,y=function(){var t=this,e=t._self._c;return e("div",{staticClass:"main"},[e("div",{staticClass:"spot"},[e("div",{staticClass:"header"},[t._v(t._s(t.currentTradePair.split("USDT")[0].toUpperCase())+"/USDT")]),e("handicapComponent",{attrs:{handicapData:t.spotHandicapData,currentTradePair:t.currentTradePair,exchangeName:t.exchangeName,symbolPrecision:t.symbolPrecision,currentPrice:t.spotPrice}})],1),e("div",{staticClass:"future"},[e("div",{staticClass:"header"},[t._v(t._s(t.currentTradePair)+"-Perp")]),e("handicapComponent",{attrs:{handicapData:t.futureHandicapData,currentTradePair:t.currentTradePair,exchangeName:t.exchangeName,symbolPrecision:t.symbolPrecision,currentPrice:t.futurePrice}})],1)])},C=[],f=function(){var t=this,e=t._self._c;return e("div",{staticClass:"tab-panel-content"},[e("div",{staticClass:"panel-content-body trades-panel"},[e("div",{staticClass:"mod-body-title"},[e("span",{staticClass:"price"},[t._v(t._s(t.$t("exchange_price"))+" (USDT)")]),e("span",{staticClass:"amount"},[t._v(t._s(t.$t("assets_quantity"))+" ("+t._s(t.currentTradePair.split("USDT")[0].toUpperCase())+")")]),e("span",{staticClass:"volume-of-trade"},[t._v(t._s(t.$t("exchange_amount"))+"("+t._s(t.currentTradePair.split("USDT")[0].toUpperCase())+")")])]),e("ul",{staticClass:"mod-body-list",class:[{"mod-body-list-full-content":"sell"===t.pageState.handicapShowType},{"mod-body-list-hide":"buy"===t.pageState.handicapShowType}]},[e("ssx-no-data",{attrs:{show:!t.handicapSells||!t.handicapSells.length,"min-height":290,color:"var(--color-text-one)"}}),t._l(t.handicapSells,(function(i,s){return e("li",{key:s,staticClass:"mod-body-list-item sell__list__item",style:{"background-size":t.sellPercent[s]+" 100%"}},[e("span",{staticClass:"price color-red"},[t._v(" "+t._s(Number(i[0]).toFix(t.symbolPrecision))+" ")]),e("span",{staticClass:"amount"},[t._v(" "+t._s(Number(i[1]).toFix(2))+" ")]),e("span",{staticClass:"volume-of-trade"},[t._v(" "+t._s(t.$NP.times(i[0],i[1]).toFix(3))+" ")])])}))],2),e("div",{staticClass:"now-price"},[e("div",{class:t.priceClass},[t._v(" "+t._s(t.currentPrice?Number(t.currentPrice).toFix(t.symbolPrecision):"--")+" ")])]),e("ul",{staticClass:"mod-body-list",class:[{"mod-body-list-full-content":"buy"===t.pageState.handicapShowType},{"mod-body-list-hide":"sell"===t.pageState.handicapShowType}]},[e("ssx-no-data",{attrs:{show:!t.handicapBuys||!t.handicapBuys.length,"min-height":310,color:"var(--color-text-one)"}}),t._l(t.handicapBuys,(function(i,s){return e("li",{key:s,staticClass:"mod-body-list-item buy__list__item",style:{"background-size":t.buyPercent[s]+" 100%"}},[e("span",{staticClass:"price color-green"},[t._v(" "+t._s(Number(i[0]).toFix(t.symbolPrecision))+" ")]),e("span",{staticClass:"amount"},[t._v(" "+t._s(Number(i[1]).toFix(2))+" ")]),e("span",{staticClass:"volume-of-trade"},[t._v(" "+t._s(t.$NP.times(i[0],i[1]).toFix(3))+" ")])])}))],2)])])},S=[],$={props:{currentTradePair:{required:!0},handicapData:{required:!0},exchangeName:{type:String},symbolPrecision:{type:Number,default:0},currentPrice:{required:!0}},data(){return{buyDefaultPrice:"",sellDefaultPrice:"",pageState:{chartsShow:"Kline",handicapShowType:"all",documentTitle:"",isBuyButtonLoading:!1,isSellButtonLoading:!1,isDeepthChartsLoading:!0,title:""},handicapSells:[],handicapBuys:[],sellPercent:[],buyPercent:[],currentSelectedArea:"",priceClass:"",price:0}},watch:{currentPrice(t){t&&(t!=this.price?(this.priceClass=Number(t)>Number(this.price)?"color-green":"color-red",this.price=t):this.priceClass="color-default",document.title=`${Number(t).toFixed(2)} | ${this.currentTradePair.toUpperCase()} ${this.pageState.title}`)},handicapData(t){if("okx"==this.exchangeName)if("snapshot"==t.action)this.handicapSells=t.a.splice(0,50).reverse(),this.handicapBuys=t.b;else{for(const e of this.handicapSells)for(const i of t.a)e[0]==i[0]&&e[1]!=i[1]&&0!=i[1]&&(e[1]=i[1]);for(const e of this.handicapBuys)for(const i of t.a)e[0]==i[0]&&e[1]!=i[1]&&0!=i[1]&&(e[1]=i[1])}else t&&t.a&&(this.handicapSells=t.a.reverse()),t.b&&t.b&&(this.handicapBuys=t.b);this.handleHandicapData()}},methods:{handicapSellDisplayHeight(){switch(this.pageState.handicapShowType){case"all":return 349.5;case"sell":return 699;case"buy":return 0;default:return 349.5}},handleHandicapData(){let t=20,e=20;switch(this.pageState.handicapShowType){case"all":break;case"sell":t=36,e=0;break;case"buy":t=0,e=36;break;default:break}const i=[];if(this.handicapSells&&this.handicapBuys.length)for(let r=0;r<this.handicapBuys.length;r++)i.push(this.handicapBuys[r][1]);if(this.handicapSells&&this.handicapSells.length)for(let r=0;r<this.handicapSells.length;r++)i.push(this.handicapSells[r][1]);const s=Math.max(...i);let a=[],n=[];if(0!==e&&(a=this.handicapBuys||[]),0!==t&&(n=this.handicapSells||[]),a.length&&a.length>e&&(a=a.slice(0,e)),n.length&&n.length>t&&(n=n.slice(-t)),this.sellPercent=[],n.length)for(let r=0;r<n.length;r++)this.sellPercent.push(100*Number(this.$NP.divide(n[r][1],s).toFixed(2))+"%");if(this.buyPercent=[],a.length)for(let r=0;r<a.length;r++)this.buyPercent.push(100*Number(this.$NP.divide(a[r][1],s).toFixed(2))+"%");this.handicapSells=n,this.handicapBuys=a,n&&n.length&&this.buyDefaultPrice!==n[n.length-1][0]&&(this.buyDefaultPrice=n[n.length-1][0]),0===n.length&&(this.buyDefaultPrice=""),a&&a.length&&this.sellDefaultPrice!==a[0][0]&&(this.sellDefaultPrice=a[0][0]),0===a.length&&(this.sellDefaultPrice="")},sellEntrustPriceModus(t){this.sellDefaultPrice=t,this.GET_SELL_DEFAULT_PRICE(this.sellDefaultPrice)},buyEntrustPriceModus(t){this.buyDefaultPrice=t,this.GET_BUY_DEFAULT_PRICE(this.buyDefaultPrice)}}},k=$,x=(i("c1e7"),Object(l["a"])(k,f,S,!1,null,"e7859fb6",null)),P=x.exports,I={components:{handicapComponent:P},props:{currentTradePair:{required:!0},exchangeName:{type:String},symbolPrecision:{type:Number,default:0},futureHandicapData:{required:!0},spotHandicapData:{required:!0},spotPrice:{required:!0},futurePrice:{required:!0}},data(){return{}},mounted(){},methods:{}},R=I,N=(i("610f"),Object(l["a"])(R,y,C,!1,null,"55082639",null)),w=N.exports,O=function(){var t=this,e=t._self._c;return e("div",{staticClass:"entrust"},[e("div",{staticClass:"tab-wrap"},t._l(t._c_tab_list,(function(i,s){return e("div",{key:s,staticClass:"tab",class:t.tabIndex===s?"actived":"",on:{click:function(e){return t.changeTab(s)}}},[t._v(t._s(i.name))])})),0),0===t.tabIndex&&t._c_list.length?e("div",{staticClass:"list"},[e("div",{staticClass:"list-header layout"},[e("div",{staticClass:"item0",style:t.autoWidth(216)},[t._v(t._s(t.$t("arbitrage_time")))]),e("div",{staticClass:"item1",style:t.autoWidth(205)},[t._v(t._s(t.$t("arbitrage_currency")))]),e("div",{staticClass:"item2",style:t.autoWidth(196)},[t._v(t._s(t.$t("arbitrage_lever")))]),e("div",{staticClass:"item3",style:t.autoWidth(267)},[t._v(t._s(t.$t("arbitrage_target_value")))]),e("div",{staticClass:"item4",style:t.autoWidth(341)},[t._v(t._s(t.$t("arbitrage_exchange")))]),e("div",{staticClass:"item5",style:t.autoWidth(335)},[t._v(t._s(t.$t("arbitrage_completed")))]),e("div",{staticClass:"between-wrap",style:t.autoWidth(335)},[e("div",{staticClass:"item6"},[t._v(t._s(t.$t("arbitrage_commission_status")))]),e("div",{staticClass:"item7"},[t._v(t._s(t.$t("arbitrage_operate")))])])]),e("div",{staticClass:"list-wrap"},t._l(t._c_list,(function(i,s){return e("div",{key:s,staticClass:"item layout pointer"},[e("div",{staticClass:"item0",style:t.autoWidth(216)},[t._v(t._s(t.$dayjs(i.createTime).format("YYYY/MM/DD HH:mm:ss"))+" ")]),e("div",{staticClass:"item1",style:t.autoWidth(205)},[t._v(t._s(i.symbol)+" ")]),e("div",{staticClass:"item2",style:t.autoWidth(196)},[t._v("X"+t._s(i.leverage))]),e("div",{staticClass:"item3",style:t.autoWidth(267)},[t._v("₮ "+t._s(t.$utils._toFix(i.targetSize,4)))]),e("div",{staticClass:"item4",style:t.autoWidth(341)},[t._v(" "+t._s(i.exchange)+" ")]),e("div",{staticClass:"item5",style:t.autoWidth(335)},[t._v("₮ "+t._s(t.$utils._toFix(Number(i.orderedSize)||0,4))+" / "+t._s(t.$utils._toFix(Number(i.orderedSize)/Number(i.targetSize)*100,0))+"%")]),e("div",{staticClass:"between-wrap",style:t.autoWidth(335)},[e("div",{staticClass:"item6"},[t._v(t._s(t.showStatus(i.status)))]),e("div",{staticClass:"item7",class:1!==i.status?"down":"",on:{click:function(e){return t.shutdownOrder(i)}}},[t._v(t._s(t.$t("arbitrage_cancel")))])])])})),0)]):t._e(),1===t.tabIndex&&t._c_list.length?e("div",{staticClass:"list"},[e("div",{staticClass:"list-header layout"},[e("div",{staticClass:"item0",style:t.autoWidth(216)},[t._v(t._s(t.$t("arbitrage_time")))]),e("div",{staticClass:"item1",style:t.autoWidth(205)},[t._v(t._s(t.$t("arbitrage_currency")))]),e("div",{staticClass:"item2",style:t.autoWidth(196)},[t._v(t._s(t.$t("arbitrage_lever")))]),e("div",{staticClass:"item3",style:t.autoWidth(267)},[t._v(t._s(t.$t("arbitrage_profit_loss")))]),e("div",{staticClass:"item4",style:t.autoWidth(341)},[t._v(t._s(t.$t("arbitrage_exchange")))]),e("div",{staticClass:"item5",style:t.autoWidth(335)},[t._v(t._s(t.$t("arbitrage_Estimated_annualized")))]),e("div",{staticClass:"between-wrap",style:t.autoWidth(335)},[e("div",{staticClass:"item6"},[t._v(t._s(t.$t("arbitrage_position_value")))]),e("div",{staticClass:"item7",on:{click:function(e){return t.position(t.item)}}},[t._v(t._s(t.$t("arbitrage_operate")))])])]),e("div",{staticClass:"list-wrap"},t._l(t._c_list,(function(i,s){return e("div",{key:s,staticClass:"item layout pointer"},[e("div",{staticClass:"item0",style:t.autoWidth(216)},[t._v(t._s(t.$dayjs(i.created).format("YYYY/MM/DD HH:mm:ss"))+" ")]),e("div",{staticClass:"item1",style:t.autoWidth(205)},[t._v(t._s(i.symbol)+" ")]),e("div",{staticClass:"item2",style:t.autoWidth(196)},[t._v("X"+t._s(i.leverage))]),e("div",{staticClass:"item3",class:{up:Number(i.pnl)>0,down:Number(i.pnl)<0,"":0===Number(i.pnl)},style:t.autoWidth(267)},[t._v("₮ "+t._s(t.$utils._toFix(i.pnl,4)))]),e("div",{staticClass:"item4",style:t.autoWidth(341)},[t._v(" "+t._s(i.exchange)+" ")]),e("div",{staticClass:"item5",style:t.autoWidth(335)},[e("currentPositionEstimateRate",{attrs:{exchange:i.exchange,symbol:i.symbol}})],1),e("div",{staticClass:"between-wrap",style:t.autoWidth(335)},[e("div",{staticClass:"item6"},[t._v("₮ "+t._s(t.$utils._toFix(i.orderedSize,4)))]),e("div",{staticClass:"item7 down",on:{click:function(e){return t.position(i)}}},[t._v(t._s(t.$t("arbitrage_close")))])])])})),0)]):t._e(),2===t.tabIndex&&t._c_list.length?e("div",{staticClass:"list"},[e("div",{staticClass:"list-header layout"},[e("div",{staticClass:"item0",style:t.autoWidth(216)},[t._v(t._s(t.$t("arbitrage_time")))]),e("div",{staticClass:"item1",style:t.autoWidth(205)},[t._v(t._s(t.$t("arbitrage_currency")))]),e("div",{staticClass:"item2",style:t.autoWidth(196)},[t._v(t._s(t.$t("arbitrage_lever")))]),e("div",{staticClass:"item3",style:t.autoWidth(267)},[t._v(t._s(t.$t("arbitrage_target_value")))]),e("div",{staticClass:"item4",style:t.autoWidth(341)},[t._v(t._s(t.$t("arbitrage_exchange")))]),e("div",{staticClass:"item5",style:t.autoWidth(335)},[t._v(t._s(t.$t("arbitrage_completed")))]),e("div",{staticClass:"between-wrap",style:t.autoWidth(335)},[e("div",{staticClass:"item6"},[t._v(t._s(t.$t("arbitrage_commission_status")))]),e("div",{staticClass:"item7"},[t._v(t._s(t.$t("arbitrage_commission_type")))])])]),e("div",{staticClass:"list-wrap"},t._l(t._c_list,(function(i,s){return e("div",{key:s,staticClass:"item layout pointer"},[e("div",{staticClass:"item0",style:t.autoWidth(216)},[t._v(t._s(t.$dayjs(i.createTime).format("YYYY/MM/DD HH:mm:ss"))+" ")]),e("div",{staticClass:"item1",style:t.autoWidth(205)},[t._v(t._s(i.symbol)+" ")]),e("div",{staticClass:"item2",style:t.autoWidth(196)},[t._v("X"+t._s(i.leverage))]),e("div",{staticClass:"item3",style:t.autoWidth(267)},[t._v("₮ "+t._s(t.$utils._toFix(i.targetSize,4)))]),e("div",{staticClass:"item4",style:t.autoWidth(341)},[t._v(" "+t._s(i.exchange)+" ")]),e("div",{staticClass:"item5",style:t.autoWidth(335)},[t._v("₮ "+t._s(t.$utils._toFix(Number(i.orderedSize)||0,4))+" / "+t._s(t.$utils._toFix(Number(i.orderedSize)/Number(i.targetSize)*100,0))+"%")]),e("div",{staticClass:"between-wrap",style:t.autoWidth(335)},[e("div",{staticClass:"item6"},[t._v(t._s(t.showStatus(i.status)))]),e("div",{staticClass:"item7"},[t._v(t._s(t.showOrderType(i.orderType)))])])])})),0)]):t._e(),t._c_list.length?t._e():e("el-empty",{attrs:{description:t.$t("notice_no_data"),image:i("e335")}}),e("el-pagination",{staticStyle:{"margin-top":"50px","text-align":"center"},attrs:{layout:"prev, pager, next",total:t._c_total,"page-size":t._c_page_size,"hide-on-single-page":!t._c_list.length},on:{"current-change":function(e){return t.handleCurrentChange(e,t.tabIndex)}}})],1)},T=[],D=function(){var t=this,e=t._self._c;return e("span",{staticClass:"wd-text-18 wd-font-bold ct-one"},[t._v(t._s(t.APR3.toFix(2))+"%")])},A=[],F={name:"ArbitrageCurrentPositionEstimateRate",props:{symbol:{type:String,required:!0},exchange:{type:String,required:!0}},data(){return{APR3:0}},mounted(){this.symbol&&this.exchange&&("binance"===this.exchange?this.onGetBinanceRate():"okx"===this.exchange&&this.onGetOkxRate())},methods:{async onGetBinanceRate(){const t=this.symbol.toUpperCase()+"USDT",e=(new Date).getTime(),i=await this.$api.market.fundingRate({symbol:t,startTime:e-2592e5,endTime:e,limit:1e3});let s=0;for(const a of i||[])s+=Number(null===a||void 0===a?void 0:a.fundingRate)||0;this.APR3=365*s/3},async onGetOkxRate(){const t=this.symbol.toUpperCase()+"-USDT-SWAP",e=(new Date).getTime(),i=await this.$api.arbitrage.onGetFundingRateHistory({before:e-2592e5,after:e,instId:t,limit:"100"});if("0"===(null===i||void 0===i?void 0:i.code)){const t=(null===i||void 0===i?void 0:i.data)||[];let e=0;for(const i of t)e+=Number(null===i||void 0===i?void 0:i.fundingRate)||0;this.APR3=365*e/3}}}},W=F,E=Object(l["a"])(W,D,A,!1,null,"19bb68dc",null),B=E.exports,M={components:{currentPositionEstimateRate:B},data(){return{tabIndex:0,clientWidth:document.body.clientWidth,currentState:{pageFrom:{pageSize:10,pageNum:1,status:"0,1",sizeType:1,sort:"desc"},total:0,list:[]},historyState:{pageFrom:{pageSize:10,pageNum:1,status:"2,3,4",sizeType:1,sort:"desc"},total:0,list:[]},positionState:{pageFrom:{pageSize:10,pageNum:1,sort:"desc"},total:0,list:[]}}},computed:{...Object(p["d"])({token:"token",userInfo:"userInfo"}),_c_tab_list(){return[{name:this.$t("arbitrage_current_commission")},{name:this.$t("arbitrage_current_position")},{name:this.$t("arbitrage_historical_transaction")}]},_c_list(){switch(this.tabIndex){case 0:return this.currentState.list;case 1:return this.positionState.list;case 2:return this.historyState.list;default:return[]}},_c_total(){switch(this.tabIndex){case 0:return this.currentState.total;case 1:return this.positionState.total;case 2:return this.historyState.total;default:return 0}},_c_page_size(){switch(this.tabIndex){case 0:return this.currentState.pageFrom.pageSize;case 1:return this.positionState.pageFrom.pageSize;case 2:return this.historyState.pageFrom.pageSize;default:return 0}}},mounted(){this.changeTab(this.tabIndex),window.addEventListener("resize ",this.handleResize)},beforeDestroy(){window.removeEventListener("resize",this.handleResize)},methods:{autoWidth(t){return{width:t/1920*this.clientWidth+"px"}},handleResize(){this.clientWidth=document.body.clientWidth},changeTab(t=this.tabIndex){if(console.log("changeTab+++",t),this.tabIndex=t,this.token)switch(t){case 0:return this.positionState.pageFrom.pageNum=1,this.historyState.pageFrom.pageNum=1,this.getUserOrder();case 1:return this.currentState.pageFrom.pageNum=1,this.historyState.pageFrom.pageNum=1,this.getUserPosition();case 2:return this.currentState.pageFrom.pageNum=1,this.positionState.pageFrom.pageNum=1,this.getUserOrder();default:return}},handleCurrentChange(t,e){switch(e){case 0:this.currentState.pageFrom.pageNum=t;break;case 1:this.positionState.pageFrom.pageNum=t;break;case 2:this.historyState.pageFrom.pageNum=t;break;default:break}this.changeTab(e)},showStatus(t){const e={0:this.$t("arbitrage_not_start"),1:this.$t("arbitrage_progress"),2:this.$t("arbitrage_completed"),3:this.$t("arbitrage_abnormal_end"),4:this.$t("arbitrage_already_cancel")};return e[t]},showOrderType(t){const e={1:this.$t("arbitrage_billing"),2:this.$t("arbitrage_close")};return e[t]},position(t){this.$confirm(this.$t("arbitrage_confirm_billing"),this.$t("notice_title_info"),{confirmButtonText:this.$t("assets_address_delete_confirm"),cancelButtonText:this.$t("assets_address_delete_cancel"),type:"warning",closeOnClickModal:!1}).then(()=>{this.$api.arbitrage.position({userId:this.userInfo.customerId,targetSize:t.targetSize,arbitrageConfigId:t.arbitrageConfigId,leverage:t.leverage,orderType:2,sizeType:1}).then(t=>{t.success&&(this.$notify({message:this.$t("arbitrage_close_success"),type:"success"}),this.changeTab(this.tabIndex))})}).catch(()=>{this.$notify({message:this.$t("live_cancel_status"),type:"info"})})},async shutdownOrder(t){if(1===t.status)return this.$notify({message:this.$t("arbitrage_cannot_cancel"),type:"error"});this.$confirm(this.$t("arbitrage_confirm_cancel"),this.$t("notice_title_info"),{confirmButtonText:this.$t("assets_address_delete_confirm"),cancelButtonText:this.$t("assets_address_delete_cancel"),type:"warning",closeOnClickModal:!1}).then(()=>{this.$api.arbitrage.shutdownOrder({orderId:t.orderId}).then(t=>{t.success&&(this.$notify({message:this.$t("arbitrage_cancel_success"),type:"success"}),this.changeTab(this.tabIndex))})}).catch(()=>{this.$notify({message:this.$t("live_cancel_status"),type:"info"})})},async getUserPosition(){try{const t=await this.$api.arbitrage.getUserPosition(this.positionState.pageFrom);t.success&&(this.positionState.total=t.obj.total,this.positionState.list=t.obj.records)}catch(t){this.$handleError.handleApiRequestException(t)}},async getUserOrder(){const t=0===this.tabIndex?this.currentState.pageFrom:this.historyState.pageFrom;try{const e=await this.$api.arbitrage.getUserOrder(t);e.success&&(0===this.tabIndex?(this.currentState.total=e.obj.total,this.currentState.list=e.obj.records):(this.historyState.total=e.obj.total,this.historyState.list=e.obj.records))}catch(e){this.$handleError.handleApiRequestException(e)}}}},U=M,L=(i("a534"),Object(l["a"])(U,O,T,!1,null,"4d921e28",null)),H=L.exports,z={components:{chart:d,formVue:v,handicap:w,entrust:H},data(){return{socket:null,spotSocket:null,futureSocket:null,tradeCoin:"BTC",priceCoin:"USDT",theme:"dark",spotHandicapData:[],futureHandicapData:[],klineData:{},spotPrice:"",futurePrice:"",updateDepthHightChartsTheme:0,exchangeName:"binance",futuresContractsList:[],okxContractsList:[],currentpair:"",chartId:1,interVal:3,timer:null,MAP_PERIOD:new Map([[0,"1m"],[1,"1m"],[2,"5m"],[3,"15m"],[4,"30m"],[5,"1h"],[6,"4h"],[7,"1d"],[8,"1w"],[9,"1M"]]),MAP_OKXPERIOD:new Map([[0,"1m"],[1,"1m"],[2,"5m"],[3,"15m"],[4,"30m"],[5,"1H"],[6,"4H"],[7,"1D"],[8,"1W"],[9,"1M"]])}},computed:{...Object(p["d"])({token:"token",userInfo:"userInfo",appStatus:"appStatus",bn_precise:t=>t.market.bn_precise,okx_precise:t=>t.market.okx_precise}),symbolPrecision(){let t=0;return t="okx"==this.exchangeName?this.okx_precise[`${this.tradeCoin}-${this.priceCoin}`.toUpperCase()]:this.bn_precise[`${this.tradeCoin}${this.priceCoin}`.toUpperCase()],t}},beforeDestroy(){"binance"==this.exchangeName?this.closeBinanceSocket():this.closeOkxSocket(),this.$store.commit("UPDATE_APP_STATUS",{appStatus:{tradeCoin:"",priceCoin:""}})},async mounted(){this.appStatus.tradeCoin&&this.appStatus.priceCoin?(this.tradeCoin=this.appStatus.tradeCoin,this.priceCoin=this.appStatus.priceCoin):(this.tradeCoin=this.$route.query.tradeCoin||"",this.priceCoin=this.$route.query.priceCoin||""),this.exchangeName=this.$route.query.exchange||"binance",this.currentpair=`${this.tradeCoin}${this.priceCoin}`.toLowerCase(),this.tradeCoin||this.priceCoin||(await this.getArbitrageList(),this.currentpair=`${this.tradeCoin}${this.priceCoin}`.toLowerCase()),"okx"==this.exchangeName?this.handleInitOkxSocket():this.handleInitSocket()},methods:{handleInitOkxSocket(){this.socket=new WebSocket(this.$getEnv("VUE_APP_OKX_SOCKET_URL")),this.socket.onopen=()=>{this.socket.send(JSON.stringify({op:"subscribe",args:[{channel:"books",instId:`${this.tradeCoin}-${this.priceCoin}`},{channel:"books",instId:`${this.tradeCoin}-${this.priceCoin}-SWAP`},{channel:"tickers",instId:`${this.tradeCoin}-${this.priceCoin}`},{channel:"tickers",instId:`${this.tradeCoin}-${this.priceCoin}-SWAP`},{channel:"candle"+this.MAP_OKXPERIOD.get(this.interVal),instId:`${this.tradeCoin}-${this.priceCoin}${1==this.chartId?"":"-SWAP"}`}]}))},this.socket.onmessage=t=>{const e=JSON.parse(t.data);if(Array.isArray(e.data)){if("books"==e.arg.channel&&e.arg.instId==`${this.tradeCoin}-${this.priceCoin}`){const t={action:e.action,a:e.data[0].asks,b:e.data[0].bids};this.spotHandicapData=t}else if("books"==e.arg.channel&&e.arg.instId==`${this.tradeCoin}-${this.priceCoin}-SWAP`){const t={action:e.action,a:e.data[0].asks,b:e.data[0].bids};this.futureHandicapData=t}else if(e.arg.channel=="candle"+this.MAP_OKXPERIOD.get(this.interVal)){const t={t:e.data[0][0],o:e.data[0][1],h:e.data[0][2],l:e.data[0][3],c:e.data[0][4],v:e.data[0][6]};this.klineData=t}else"tickers"==e.arg.channel&&e.arg.instId==`${this.tradeCoin}-${this.priceCoin}`?this.spotPrice=e.data[0].last:"tickers"==e.arg.channel&&e.arg.instId==`${this.tradeCoin}-${this.priceCoin}-SWAP`&&(this.futurePrice=e.data[0].last);this.socketPing(e.arg.channel)}}},handleInitSocket(){this.spotSocket=new WebSocket(this.$getEnv("VUE_APP_SPOT_SOCKET_URL")),this.futureSocket=new WebSocket(this.$getEnv("VUE_APP_PUSHER_SOCKET_URL")),this.spotSocket.onopen=()=>{this.spotSocket.send(JSON.stringify({method:"SUBSCRIBE",params:[this.currentpair+"@ticker",this.currentpair+"@depth20",1==this.chartId?`${this.currentpair}@kline_${this.MAP_PERIOD.get(this.interVal)}`:""],id:2}))},this.spotSocket.onmessage=t=>{const e=JSON.parse(t.data);if("kline"==e.e)this.klineData=e.k;else if("24hrTicker"==e.e)this.spotPrice=e.c;else{const t={a:e.asks,b:e.bids};this.spotHandicapData=t}},this.futureSocket.onopen=()=>{this.futureSocket.send(JSON.stringify({method:"SUBSCRIBE",params:[this.currentpair+"@ticker",this.currentpair+"@depth20@500ms",2==this.chartId?`${this.currentpair}_perpetual@continuousKline_${this.MAP_PERIOD.get(this.interVal)}`:""],id:2}))},this.futureSocket.onmessage=t=>{const e=JSON.parse(t.data);"depthUpdate"==e.e?this.futureHandicapData=e:"continuous_kline"==e.e?this.klineData=e.k:"24hrTicker"==e.e&&(this.futurePrice=e.c)}},socketPing(){clearInterval(this.timer),this.timer=setInterval(()=>{this.socket.send("ping")},2e4)},async getArbitrageList(){const t=await this.$api.market.getArbitrageList({exchange:this.exchangeName,pageSize:1e3});t.success&&(this.tradeCoin=t.obj.records[0].leftTradeCoin,this.priceCoin=t.obj.records[0].leftPriceCoin)},toggleExchange(t){t.name!=this.exchangeName&&(this.exchangeName=t.name,this.tradeCoin=t.symbol,this.currentpair=`${this.tradeCoin}${this.priceCoin}`.toLowerCase(),"okx"==this.exchangeName?(this.closeBinanceSocket(),this.handleInitOkxSocket()):(this.closeOkxSocket(),this.handleInitSocket()))},toggleSymbol(t){if(this.tradeCoin==t)return;const e=this.currentpair,i=this.tradeCoin;this.tradeCoin=t,this.currentpair=`${this.tradeCoin}${this.priceCoin}`.toLowerCase(),"okx"==this.exchangeName?(this.socket.send(JSON.stringify({op:"unsubscribe",args:[{channel:"books",instId:`${i}-${this.priceCoin}`},{channel:"books",instId:`${i}-${this.priceCoin}-SWAP`},{channel:"tickers",instId:`${i}-${this.priceCoin}`},{channel:"tickers",instId:`${i}-${this.priceCoin}-SWAP`},{channel:"candle"+this.MAP_OKXPERIOD.get(this.interVal),instId:`${i}-${this.priceCoin}${1==this.chartId?"":"-SWAP"}`}]})),this.socket.send(JSON.stringify({op:"subscribe",args:[{channel:"books",instId:`${this.tradeCoin}-${this.priceCoin}`},{channel:"books",instId:`${this.tradeCoin}-${this.priceCoin}-SWAP`},{channel:"tickers",instId:`${this.tradeCoin}-${this.priceCoin}`},{channel:"tickers",instId:`${this.tradeCoin}-${this.priceCoin}-SWAP`},{channel:"candle"+this.MAP_OKXPERIOD.get(this.interVal),instId:`${this.tradeCoin}-${this.priceCoin}${1==this.chartId?"":"-SWAP"}`}]}))):(this.spotSocket.send(JSON.stringify({method:"UNSUBSCRIBE",params:[e+"@ticker",e+"@depth20",1==this.chartId?`${e}@kline_${this.MAP_PERIOD.get(this.interVal)}`:""],id:2})),this.spotSocket.send(JSON.stringify({method:"SUBSCRIBE",params:[this.currentpair+"@ticker",this.currentpair+"@depth20",1==this.chartId?`${this.currentpair}@kline_${this.MAP_PERIOD.get(this.interVal)}`:""],id:2})),this.futureSocket.send(JSON.stringify({method:"UNSUBSCRIBE",params:[e+"@ticker",e+"@depth20@500ms",2==this.chartId?`${e}_perpetual@continuousKline_${this.MAP_PERIOD.get(this.interVal)}`:""],id:2})),this.futureSocket.send(JSON.stringify({method:"SUBSCRIBE",params:[this.currentpair+"@ticker",this.currentpair+"@depth20@500ms",2==this.chartId?`${this.currentpair}_perpetual@continuousKline_${this.MAP_PERIOD.get(this.interVal)}`:""],id:2})))},closeBinanceSocket(){1==this.chartId?this.spotSocket.send(JSON.stringify({method:"UNSUBSCRIBE",params:[this.currentpair+"@ticker",this.currentpair+"@depth20",`${this.currentpair}@kline_${this.MAP_PERIOD.get(this.interVal)}${this.MAP_PERIOD.get(this.interVal)}`],id:2})):this.futureSocket.send(JSON.stringify({method:"UNSUBSCRIBE",params:[this.currentpair+"@ticker",this.currentpair+"@depth20@500ms",`${this.currentpair}_perpetual@continuousKline_${this.MAP_PERIOD.get(this.interVal)}${this.MAP_PERIOD.get(this.interVal)}`],id:2})),this.spotSocket.close(),this.futureSocket.close(),this.futureSocket=null,this.spotSocket=null},closeOkxSocket(){this.socket.send(JSON.stringify({op:"unsubscribe",args:[{channel:"tickers",instId:`${this.tradeCoin}-${this.priceCoin}`},{channel:"tickers",instId:`${this.tradeCoin}-${this.priceCoin}-SWAP`},{channel:"books",instId:`${this.tradeCoin}-${this.priceCoin}${1==this.chartId?"":"-SWAP"}`},{channel:"candle"+this.MAP_OKXPERIOD.get(this.interVal),instId:`${this.tradeCoin}-${this.priceCoin}${1==this.chartId?"":"-SWAP"}`}]})),this.socket.close(),this.socket=null,clearInterval(this.timer)},toggleChart(t){this.chartId=t,"binance"==this.exchangeName?this.spotSocket&&this.futureSocket&&(1==this.chartId?(this.futureSocket.send(JSON.stringify({method:"UNSUBSCRIBE",params:[`${this.currentpair}_perpetual@continuousKline_${this.MAP_PERIOD.get(this.interVal)}`],id:2})),this.spotSocket.send(JSON.stringify({method:"SUBSCRIBE",params:[`${this.currentpair}@kline_${this.MAP_PERIOD.get(this.interVal)}`],id:2})),this.spotSocket.onmessage=t=>{const e=JSON.parse(t.data).data;if("kline"==e.e)this.klineData=e.k;else if("24hrTicker"==e.e)this.spotPrice=e.c;else{const t={a:e.asks,b:e.bids};this.spotHandicapData=t}}):(this.spotSocket.send(JSON.stringify({method:"UNSUBSCRIBE",params:[`${this.currentpair}@kline_${this.MAP_PERIOD.get(this.interVal)}`],id:2})),this.futureSocket.send(JSON.stringify({method:"SUBSCRIBE",params:[`${this.currentpair}_perpetual@continuousKline_${this.MAP_PERIOD.get(this.interVal)}`],id:2})),this.futureSocket.onmessage=t=>{const e=JSON.parse(t.data);"depthUpdate"==e.e?this.futureHandicapData=e:"continuous_kline"==e.e?this.klineData=e.k:"24hrTicker"==e.e&&(this.futurePrice=e.c)})):this.socket&&(this.socket.send(JSON.stringify({op:"unsubscribe",args:[{channel:"candle"+this.MAP_OKXPERIOD.get(this.interVal),instId:`${this.tradeCoin}-${this.priceCoin}${1==this.chartId?"-SWAP":""}`}]})),this.socket.send(JSON.stringify({op:"subscribe",args:[{channel:"candle"+this.MAP_OKXPERIOD.get(this.interVal),instId:`${this.tradeCoin}-${this.priceCoin}${1==this.chartId?"":"-SWAP"}`}]})))},changeInterval(t){if("okx"==this.exchangeName)this.socket.send(JSON.stringify({op:"unsubscribe",args:[{channel:"candle"+this.MAP_OKXPERIOD.get(this.interVal),instId:`${this.tradeCoin}-${this.priceCoin}${1==this.chartId?"":"-SWAP"}`}]})),this.socket.send(JSON.stringify({op:"subscribe",args:[{channel:"candle"+this.MAP_OKXPERIOD.get(t),instId:`${this.tradeCoin}-${this.priceCoin}${1==this.chartId?"":"-SWAP"}`}]}));else{let e;e=1==this.chartId?this.spotSocket:this.futureSocket,e.send(JSON.stringify({method:"UNSUBSCRIBE",params:[`${this.currentpair}${1==this.chartId?"@kline_":"_perpetual@continuousKline_"}${this.MAP_PERIOD.get(this.interVal)}`],id:2})),e.send(JSON.stringify({method:"SUBSCRIBE",params:[`${this.currentpair}${1==this.chartId?"@kline_":"_perpetual@continuousKline_"}${this.MAP_PERIOD.get(t)}`],id:2}))}this.interVal=t},orderSuccess(){this.$refs.entrust.changeTab()}}},j=z,K=(i("7c28"),Object(l["a"])(j,s,a,!1,null,"7cc5f342",null));e["default"]=K.exports},"4c31":function(t,e,i){},"610f":function(t,e,i){"use strict";i("e80d")},"68a8":function(t,e,i){"use strict";i("c520")},"7c28":function(t,e,i){"use strict";i("1d55")},"8b43":function(t,e,i){"use strict";i("c441")},a534:function(t,e,i){"use strict";i("104e")},c1e7:function(t,e,i){"use strict";i("4c31")},c441:function(t,e,i){},c520:function(t,e,i){},e335:function(t,e,i){t.exports=i.p+"img/list.e55dcec1.png"},e80d:function(t,e,i){}}]);