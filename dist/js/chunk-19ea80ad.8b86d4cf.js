(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-19ea80ad"],{"09c1":function(e,a,t){"use strict";t("3c0e")},"1e28":function(e){e.exports=JSON.parse('{"grinning":{"keywords":["face","smile","happy","joy",":D","grin"],"char":"😀","fitzpatrick_scale":false,"category":"people"},"grin":{"keywords":["face","happy","smile","joy","kawaii"],"char":"😁","fitzpatrick_scale":false,"category":"people"},"smiley":{"keywords":["face","happy","joy","haha",":D",":)","smile","funny"],"char":"😃","fitzpatrick_scale":false,"category":"people"},"smile":{"keywords":["face","happy","joy","funny","haha","laugh","like",":D",":)"],"char":"😄","fitzpatrick_scale":false,"category":"people"},"sweat_smile":{"keywords":["face","hot","happy","laugh","sweat","smile","relief"],"char":"😅","fitzpatrick_scale":false,"category":"people"},"laughing":{"keywords":["happy","joy","lol","satisfied","haha","face","glad","XD","laugh"],"char":"😆","fitzpatrick_scale":false,"category":"people"},"innocent":{"keywords":["face","angel","heaven","halo"],"char":"😇","fitzpatrick_scale":false,"category":"people"},"wink":{"keywords":["face","happy","mischievous","secret",";)","smile","eye"],"char":"😉","fitzpatrick_scale":false,"category":"people"},"blush":{"keywords":["face","smile","happy","flushed","crush","embarrassed","shy","joy"],"char":"😊","fitzpatrick_scale":false,"category":"people"},"slightly_smiling_face":{"keywords":["face","smile"],"char":"🙂","fitzpatrick_scale":false,"category":"people"},"yum":{"keywords":["happy","joy","tongue","smile","face","silly","yummy","nom","delicious","savouring"],"char":"😋","fitzpatrick_scale":false,"category":"people"},"heart_eyes":{"keywords":["face","love","like","affection","valentines","infatuation","crush","heart"],"char":"😍","fitzpatrick_scale":false,"category":"people"},"kissing_heart":{"keywords":["face","love","like","affection","valentines","infatuation","kiss"],"char":"😘","fitzpatrick_scale":false,"category":"people"},"kissing":{"keywords":["love","like","face","3","valentines","infatuation","kiss"],"char":"😗","fitzpatrick_scale":false,"category":"people"},"kissing_smiling_eyes":{"keywords":["face","affection","valentines","infatuation","kiss"],"char":"😙","fitzpatrick_scale":false,"category":"people"},"kissing_closed_eyes":{"keywords":["face","love","like","affection","valentines","infatuation","kiss"],"char":"😚","fitzpatrick_scale":false,"category":"people"},"stuck_out_tongue_winking_eye":{"keywords":["face","prank","childish","playful","mischievous","smile","wink","tongue"],"char":"😜","fitzpatrick_scale":false,"category":"people"},"stuck_out_tongue_closed_eyes":{"keywords":["face","prank","playful","mischievous","smile","tongue"],"char":"😝","fitzpatrick_scale":false,"category":"people"},"stuck_out_tongue":{"keywords":["face","prank","childish","playful","mischievous","smile","tongue"],"char":"😛","fitzpatrick_scale":false,"category":"people"},"sunglasses":{"keywords":["face","cool","smile","summer","beach","sunglass"],"char":"😎","fitzpatrick_scale":false,"category":"people"},"roll_eyes":{"keywords":["face","eyeroll","frustrated"],"char":"🙄","fitzpatrick_scale":false,"category":"people"},"flushed":{"keywords":["face","blush","shy","flattered"],"char":"😳","fitzpatrick_scale":false,"category":"people"},"rage":{"keywords":["angry","mad","hate","despise"],"char":"😡","fitzpatrick_scale":false,"category":"people"},"confused":{"keywords":["face","indifference","huh","weird","hmmm",":/"],"char":"😕","fitzpatrick_scale":false,"category":"people"},"tired_face":{"keywords":["sick","whine","upset","frustrated"],"char":"😫","fitzpatrick_scale":false,"category":"people"},"triumph":{"keywords":["face","gas","phew","proud","pride"],"char":"😤","fitzpatrick_scale":false,"category":"people"},"fearful":{"keywords":["face","scared","terrified","nervous","oops","huh"],"char":"😨","fitzpatrick_scale":false,"category":"people"},"disappointed_relieved":{"keywords":["face","phew","sweat","nervous"],"char":"😥","fitzpatrick_scale":false,"category":"people"},"sleepy":{"keywords":["face","tired","rest","nap"],"char":"😪","fitzpatrick_scale":false,"category":"people"},"sweat":{"keywords":["face","hot","sad","tired","exercise"],"char":"😓","fitzpatrick_scale":false,"category":"people"},"dizzy_face":{"keywords":["spent","unconscious","xox","dizzy"],"char":"😵","fitzpatrick_scale":false,"category":"people"},"astonished":{"keywords":["face","xox","surprised","poisoned"],"char":"😲","fitzpatrick_scale":false,"category":"people"},"sneezing_face":{"keywords":["face","gesundheit","sneeze","sick","allergy"],"char":"🤧","fitzpatrick_scale":false,"category":"people"},"mask":{"keywords":["face","sick","ill","disease"],"char":"😷","fitzpatrick_scale":false,"category":"people"},"face_with_thermometer":{"keywords":["sick","temperature","thermometer","cold","fever"],"char":"🤒","fitzpatrick_scale":false,"category":"people"},"face_with_head_bandage":{"keywords":["injured","clumsy","bandage","hurt"],"char":"🤕","fitzpatrick_scale":false,"category":"people"},"sleeping":{"keywords":["face","tired","sleepy","night","zzz"],"char":"😴","fitzpatrick_scale":false,"category":"people"},"zzz":{"keywords":["sleepy","tired","dream"],"char":"💤","fitzpatrick_scale":false,"category":"people"},"clap":{"keywords":["hands","praise","applause","congrats","yay"],"char":"👏","fitzpatrick_scale":true,"category":"people"},"call_me_hand":{"keywords":["hands","gesture"],"char":"🤙","fitzpatrick_scale":true,"category":"people"},"+1":{"keywords":["thumbsup","yes","awesome","good","agree","accept","cool","hand","like"],"char":"👍","fitzpatrick_scale":true,"category":"people"},"-1":{"keywords":["thumbsdown","no","dislike","hand"],"char":"👎","fitzpatrick_scale":true,"category":"people"},"facepunch":{"keywords":["angry","violence","fist","hit","attack","hand"],"char":"👊","fitzpatrick_scale":true,"category":"people"},"fist":{"keywords":["fingers","hand","grasp"],"char":"✊","fitzpatrick_scale":true,"category":"people"},"v":{"keywords":["fingers","ohyeah","hand","peace","victory","two"],"char":"✌","fitzpatrick_scale":true,"category":"people"},"ok_hand":{"keywords":["fingers","limbs","perfect","ok","okay"],"char":"👌","fitzpatrick_scale":true,"category":"people"},"raised_hand":{"keywords":["fingers","stop","highfive","palm","ban"],"char":"✋","fitzpatrick_scale":true,"category":"people"},"raised_back_of_hand":{"keywords":["fingers","raised","backhand"],"char":"🤚","fitzpatrick_scale":true,"category":"people"},"muscle":{"keywords":["arm","flex","hand","summer","strong","biceps"],"char":"💪","fitzpatrick_scale":true,"category":"people"},"handshake":{"keywords":["agreement","shake"],"char":"🤝","fitzpatrick_scale":false,"category":"people"},"point_left":{"keywords":["direction","fingers","hand","left"],"char":"👈","fitzpatrick_scale":true,"category":"people"},"point_right":{"keywords":["fingers","hand","direction","right"],"char":"👉","fitzpatrick_scale":true,"category":"people"},"fu":{"keywords":["hand","fingers","rude","middle","flipping"],"char":"🖕","fitzpatrick_scale":true,"category":"people"},"raised_hand_with_fingers_splayed":{"keywords":["hand","fingers","palm"],"char":"🖐","fitzpatrick_scale":true,"category":"people"},"lips":{"keywords":["mouth","kiss"],"char":"👄","fitzpatrick_scale":false,"category":"people"},"ear":{"keywords":["face","hear","sound","listen"],"char":"👂","fitzpatrick_scale":true,"category":"people"},"eyes":{"keywords":["look","watch","stalk","peek","see"],"char":"👀","fitzpatrick_scale":false,"category":"people"},"santa":{"keywords":["festival","man","male","xmas","father christmas"],"char":"🎅","fitzpatrick_scale":true,"category":"people"},"sun_with_face":{"keywords":["nature","morning","sky"],"char":"🌞","fitzpatrick_scale":false,"category":"animals_and_nature"},"crescent_moon":{"keywords":["night","sleep","sky","evening","magic"],"char":"🌙","fitzpatrick_scale":false,"category":"animals_and_nature"},"star":{"keywords":["night","yellow"],"char":"⭐","fitzpatrick_scale":false,"category":"animals_and_nature"},"zap":{"keywords":["thunder","weather","lightning bolt","fast"],"char":"⚡","fitzpatrick_scale":false,"category":"animals_and_nature"},"fire":{"keywords":["hot","cook","flame"],"char":"🔥","fitzpatrick_scale":false,"category":"animals_and_nature"},"snowflake":{"keywords":["winter","season","cold","weather","christmas","xmas"],"char":"❄️","fitzpatrick_scale":false,"category":"animals_and_nature"},"soccer":{"keywords":["sports","football"],"char":"⚽","fitzpatrick_scale":false,"category":"activity"},"basketball":{"keywords":["sports","balls","NBA"],"char":"🏀","fitzpatrick_scale":false,"category":"activity"},"football":{"keywords":["sports","balls","NFL"],"char":"🏈","fitzpatrick_scale":false,"category":"activity"},"baseball":{"keywords":["sports","balls"],"char":"⚾","fitzpatrick_scale":false,"category":"activity"},"gift":{"keywords":["present","birthday","christmas","xmas"],"char":"🎁","fitzpatrick_scale":false,"category":"objects"},"tada":{"keywords":["party","congratulations","birthday","magic","circus","celebration"],"char":"🎉","fitzpatrick_scale":false,"category":"objects"},"black_nib":{"keywords":["pen","stationery","writing","write"],"char":"✒️","fitzpatrick_scale":false,"category":"objects"},"memo":{"keywords":["write","documents","stationery","pencil","paper","writing","legal","exam","quiz","test","study","compose"],"char":"📝","fitzpatrick_scale":false,"category":"objects"},"heart":{"keywords":["love","like","valentines"],"char":"❤️","fitzpatrick_scale":false,"category":"symbols"},"yellow_heart":{"keywords":["love","like","affection","valentines"],"char":"💛","fitzpatrick_scale":false,"category":"symbols"},"green_heart":{"keywords":["love","like","affection","valentines"],"char":"💚","fitzpatrick_scale":false,"category":"symbols"},"vs":{"keywords":["words","orange-square"],"char":"🆚","fitzpatrick_scale":false,"category":"symbols"},"speech_balloon":{"keywords":["bubble","words","message","talk","chatting"],"char":"💬","fitzpatrick_scale":false,"category":"symbols"},"clock1":{"keywords":["time","late","early","schedule"],"char":"🕐","fitzpatrick_scale":false,"category":"symbols"}}')},"3c0e":function(e,a,t){},"8e3e":function(e,a,t){"use strict";t.r(a);var s=function(){var e=this,a=e._self._c;return a("div",{staticClass:"letter-warp"},[a("div",{staticClass:"content"},[a("div",{staticClass:"header-box",staticStyle:{height:"95px"}},[a("Avatar",{attrs:{avatarSize:60,isShowNickname:!0,userId:e.activeItem}})],1),a("div",{staticClass:"content-box"},[a("div",{staticClass:"tips",style:"display:"+e.tipsStyle},[a("span",[e._v(" "+e._s(e.$t("letter_present_all"))+" ")]),a("i",{staticClass:"el-icon-close tips-icon",on:{click:function(a){e.tipsStyle="none"}}})]),a("div",{ref:"content",staticClass:"content-ee"},[e.data.history?[e._l(e.data.history,(function(t,s){return a("div",{key:s,staticClass:"content-item-data"},[t.fromClient!=e.userInfo.customerId?a("div",{staticClass:"item-data-left"},[a("Avatar",{attrs:{avatarSize:30,isShowNickname:!0,userId:t.fromClient}},[t.msgBody?a("div",{staticClass:"data-bottom",attrs:{slot:"bottom"},slot:"bottom"},["0"==JSON.parse(t.msgBody).type?a("div",[e._v(" "+e._s(JSON.parse(t.msgBody).message)+" ")]):e._e(),"1"==JSON.parse(t.msgBody).type?a("div",{staticStyle:{display:"flex","flex-direction":"column"}},e._l(JSON.parse(JSON.parse(t.msgBody).message),(function(e,s){return a("el-image",{key:s,staticStyle:{width:"100px","margin-bottom":"10px"},attrs:{src:e,"preview-src-list":JSON.parse(JSON.parse(t.msgBody).message)}})})),1):e._e()]):e._e()])],1):a("div",{staticClass:"item-data-right",staticStyle:{display:"flex","justify-content":"flex-end"}},[a("Avatar",{attrs:{nicknameBoxStyle:"margin-right:10px;font-size:12px' : 'margin-left:10px;font-size:12px",avatarBoxStyle:"flex-direction: row-reverse;",avatarSize:30,isShowNickname:!0,userId:t.fromClient}},[a("div",{staticClass:"data-bottom data-bottom-right",attrs:{slot:"bottom"},slot:"bottom"},["0"==JSON.parse(t.msgBody).type?a("span",[e._v(" "+e._s(JSON.parse(t.msgBody).message)+" ")]):e._e(),"1"==JSON.parse(t.msgBody).type?a("div",e._l(JSON.parse(JSON.parse(t.msgBody).message),(function(e,s){return a("el-image",{key:s,staticStyle:{width:"100px","margin-bottom":"10px"},attrs:{src:e,"preview-src-list":JSON.parse(JSON.parse(t.msgBody).message)}})})),1):e._e()])])],1)])})),e.isFollowTwoWay?e._e():a("div",{staticClass:"is-follow"},[e._v(" "+e._s(e.$t("letter_Since_all"))+" ")])]:e._e()],2),a("div",{staticClass:"but-box"},[a("div",{staticClass:"input-box"},[a("el-input",{attrs:{type:"textarea",rows:e.rows,maxlength:"140",placeholder:`回复${e.userInfoName.nickName}:`},on:{focus:e.focusInput,blur:e.blurInput},model:{value:e.message,callback:function(a){e.message=a},expression:"message"}}),a("div",{staticClass:"icon-box"},[a("el-upload",{staticClass:"upload-demo",attrs:{multiple:"","auto-upload":!1,action:"","on-change":e.handleChange,"file-list":e.fileList,"show-file-list":!1,limit:9}},[a("svg-icon",{staticStyle:{"margin-right":"20px"},attrs:{data_iconName:"file1"}})],1),a("div",{staticStyle:{"margin-right":"20px",cursor:"pointer"},on:{click:function(a){e.expressionShow=!0}}},[a("svg-icon",{attrs:{data_iconName:"phiz1"}})],1),e.expressionShow?a("div",{staticClass:"biaoqing-warp",on:{click:function(a){e.expressionShow=!1}}}):e._e(),e.expressionShow?a("div",{staticClass:"biaoqing-box"},e._l(e.faceList,(function(t,s){return a("div",{key:s,staticClass:"expression-box-item",on:{click:function(a){a.stopPropagation(),e.$throttle(()=>e.getBrow(s))}}},[e._v(" "+e._s(t)+" ")])})),0):e._e()],1)],1),a("div",{staticClass:"submit",on:{click:function(a){return e.send("0")}}},[e._v(" "+e._s(e.$t("community_send"))+" ")])])])])])},i=[],r=(t("14d9"),t("2f62")),c=t("6ca8"),o=t.n(c),l=t("1e28"),n=t("d78d"),p={data(){return{tipsStyle:"flex",dataList:this.privateList,data:{history:[]},fileList:[],activeItem:"",Socket:null,message:"",messageImgUrl:"",rows:1,faceList:[],expressionShow:!1,isFollowTwoWay:!0,userInfoName:{}}},computed:{...Object(r["d"])({userInfo:e=>e.userInfo,token:"token"})},watch:{"privateList.length":{handler(){this.getList()},deep:!0,immediate:!0},"$route.params.id"(e){this.getList()}},props:{privateList:{type:Array,default:()=>[]}},mounted(){this.getList(),this.faceContent(),document.querySelector(".content-ee").addEventListener("scroll",this.scrolling)},methods:{async notifyRead(e){await this.$api.notice.readByMsg({toClient:e.toClient,fromClient:e.fromClient,outMsgType:e.outMsgType})},async onGetUserAvatarInfo(e){const a=await Object(n["a"])([e]);if(200===a.code){const e=a.data[0];e&&(this.userInfoName={...e})}},async isFollowTwoWayfn(){const e=await this.$api.community.isFollowTwoWay({userId:this.userInfo.customerId,targetUserId:this.data.userId});e.success&&(this.isFollowTwoWay=2==e.obj)},scrolling(){let e=document.querySelector(".content-ee").scrollTop;this.data.isPaging||0!==e||this.getMsgHistory(this.data,!0)},getBrow(e){for(let a in this.faceList)e==a&&(this.message+=this.faceList[e]);this.expressionShow=!1},faceContent(){for(let e in l)this.faceList.push(l[e].char)},async send(e){if("0"==e&&!this.message.trim())return this.$notify({message:this.$t("community_enter_content"),type:"warning"});const a=await this.$api.community.ctmessageSendMsg({message:"1"==e?JSON.stringify([this.messageImgUrl]):this.message,messageType:e,targetUserId:this.data.userId});a.success&&(this.$notify({message:this.$t(a.code),type:"success"}),this.message="")},async addpicture(e){let a=new FormData;a.append("file",e.file);const t=await this.$api.mine.uploadApi(a);t.success&&(this.messageImgUrl=`${this.$getEnv("VUE_APP_ALIOSS_URL")}/${t.obj.toString()}`,this.send("1"),this.fileList=[])},handleChange(e){const a="image/jpg"===e.raw.type,t="image/png"===e.raw.type,s="image/jpeg"===e.raw.type;if(console.log(e.raw.type),!a&&!t&&!s)return this.$notify({message:this.$t("account_center_pictures"),type:"warning"}),!1;o()(e.raw,{quality:.2}).then(e=>{let a=e.origin.name,t=e.origin.type,s=new File([e.file],a,{type:t});this.addpicture({file:s})}).catch(e=>{this.$handleError.handleApiRequestException(e)})},focusInput(){this.rows=7},blurInput(){this.rows=1},scrollOn(){this.$nextTick(()=>{var e=this.$el.querySelector(".content-ee");e.scrollTop=e.scrollHeight})},activeUser(e){this.tipsStyle="flex",this.message="",this.activeItem=e.userId,this.data=e,this.onGetUserAvatarInfo(this.activeItem),this.isFollowTwoWayfn(),this.scrollOn(),this.notifyRead({toClient:this.userInfo.customerId,fromClient:e.userId,outMsgType:"ctDirectMsg"})},handleLink(e){let a="";var t,s;e&&0!==e.length&&(null!==(t=e[e.length-1])&&void 0!==t&&t.msgBody?(e=JSON.parse(null===(s=e[e.length-1])||void 0===s?void 0:s.msgBody),a=0==e.type?e.message:`[${this.$t("community_picture")}]`):a=`[${this.$t("community_picture")}]`);return a},async getMsgHistory(e,a){if(a){const a=await this.$api.community.getMsgHistory({targetUserId:e.userId,limit:10,time:this.$dayjs(this.data.history[0].created).format("YYYY/MM/DD HH:mm:ss")});if(a.success){0==a.obj.length&&this.$set(e,"isPaging",!0);let t=[...a.obj.reverse(),...e.history];this.$set(e,"history",t)}}else{const a=await this.$api.community.getMsgHistory({targetUserId:e.userId,limit:10});a.success&&(this.$set(e,"history",a.obj.reverse()),this.scrollOn())}},async getList(){this.privateList.map(e=>{this.$route.params.id&&this.$route.params.id==e.userId&&(this.activeItem=e.userId||"",this.data=e,this.activeUser(e)),this.getMsgHistory(e)})}}},y=p,f=(t("09c1"),t("2877")),h=Object(f["a"])(y,s,i,!1,null,"aab7dab8",null);a["default"]=h.exports}}]);